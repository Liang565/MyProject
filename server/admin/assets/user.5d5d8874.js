import{d as W,p as f,g as X,r as d,o as Y,h as Z,j as _,i as e,w as t,l as u,x as S,n as r}from"./vendor.fd5a6943.js";import"./http.7ef13b95.js";import{a as h}from"./api.2aedc38d.js";import"./admin-store.d62c6d54.js";import{C as ee}from"./crud-api.755a1146.js";import{U as I,L as F}from"./UserOutlined.28c5c10c.js";const ue=_("div",{class:"text-2xl"},"\u7528\u6237\u7BA1\u7406",-1),ae={class:"my-2"},te=r("\u65B0\u589E\u7528\u6237"),le={class:"mb-5"},se=r("\u641C\u7D22"),oe=r("\u4FEE\u6539"),ne=r("\u5220\u9664"),re=r("ADMIN"),ie=r("USER"),de=r("\u542F\u7528"),me=r("\u7981\u7528"),pe=r("ADMIN"),ve=r("USER"),_e=r("\u542F\u7528"),fe=r("\u7981\u7528"),Ee=W({setup(be){const{remove:M,viss:p,editOk:O,addOk:T,fetch:N,data:q,query:ce,where:b,search:P,pagination:j,pageChange:R}=ee("users");let V=f("add"),s=f({username:"",password:"",pass:"",role:"user",state:!0,promiss:[]});const K=()=>{s.value={username:"",password:"",pass:"",role:"user",state:!0,promiss:[]}},E=()=>{K(),console.log("cancel")};let n=f();const U=()=>{p.value.add,n.value=="false"?s.value.state=!1:s.value.state=!0};let c=f(!0);var w=(i,a,m)=>!a&&!p.value.edit?Promise.reject("\u8BF7\u8F93\u5165\u5BC6\u7801"):a!=s.value.pass?(c.value=!0,Promise.reject("\u4E24\u6B21\u8F93\u5165\u5BC6\u7801\u4E0D\u4E00\u81F4")):(c.value=!1,Promise.resolve());const L=()=>{p.value.add=!0,console.log("newUser"),n.value="true"},$=i=>{n.value=i.state.toString(),c.value=!1,s.value.username=i.username,s.value.role=i.role,s.value.promiss=i.promiss,p.value.edit=!0,y.value=i._id};let y=f("");const z=(i,a)=>{for(let m in a)a[m]==""&&m!="promiss"&&delete a[m];O(i,a)};b.value={_id:"",username:""};let D=f([]);const G=async()=>{const i=await h.promiss.find();D.value=i.data.map(a=>({label:a.name,value:a._id}))};return X(()=>{N(),G()}),(i,a)=>{const m=d("a-button"),C=d("a-input"),o=d("a-form-item"),x=d("a-form"),g=d("a-table-column"),H=d("a-table"),k=d("a-input-password"),v=d("a-radio-button"),B=d("a-radio-group"),A=d("a-modal"),J=d("a-checkbox-group");return Y(),Z("div",null,[ue,_("div",null,[_("div",ae,[e(m,{onClick:L,type:"primary"},{default:t(()=>[te]),_:1})]),_("div",le,[e(x,{layout:"inline"},{default:t(()=>[e(o,{label:"id",class:"w-52"},{default:t(()=>[e(C,{value:u(b)._id,"onUpdate:value":a[0]||(a[0]=l=>u(b)._id=l)},null,8,["value"])]),_:1}),e(o,{label:"\u7528\u6237\u540D",class:"w-44"},{default:t(()=>[e(C,{value:u(b).username,"onUpdate:value":a[1]||(a[1]=l=>u(b).username=l)},null,8,["value"])]),_:1}),e(o,null,{default:t(()=>[e(m,{type:"primary",onClick:u(P)},{default:t(()=>[se]),_:1},8,["onClick"])]),_:1})]),_:1})]),_("div",null,[e(H,{dataSource:u(q),rowKey:"_id",pagination:u(j),onChange:u(R)},{default:t(()=>[e(g,{title:"id",dataIndex:"_id",key:"_id"}),e(g,{title:"username",dataIndex:"username",key:"username"}),e(g,{title:"role",dataIndex:"role",key:"role"}),e(g,{title:"state",dataIndex:"STATE",key:"STATE"}),e(g,{key:"setting",title:"setting"},{default:t(({record:l})=>[_("div",null,[e(m,{onClick:Q=>$(l)},{default:t(()=>[oe]),_:2},1032,["onClick"]),e(m,{onClick:Q=>u(M)(l,l.username)},{default:t(()=>[ne]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["dataSource","pagination","onChange"])])]),_("div",null,[e(A,{visible:u(p).add,"onUpdate:visible":a[7]||(a[7]=l=>u(p).add=l),title:"\u65B0\u589E\u7528\u6237",onOk:a[8]||(a[8]=l=>u(T)(u(s),u(V))),"ok-button-props":{disabled:u(c)},afterClose:E},{default:t(()=>[e(x,{model:u(s)},{default:t(()=>[e(o,{label:"username",name:"username",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",trigger:"blur"},{min:3,max:10,message:"\u7528\u6237\u540D\u957F\u5EA63-10"},{}]},{default:t(()=>[e(C,{value:u(s).username,"onUpdate:value":a[2]||(a[2]=l=>u(s).username=l)},{prefix:t(()=>[e(u(I),{class:"site-form-item-icon"})]),_:1},8,["value"])]),_:1}),e(o,{label:"\u8F93\u5165\u5BC6\u7801",name:"pass",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801",trigger:"blur"},{min:3,max:10,message:"\u5BC6\u7801\u957F\u5EA63-10"}]},{default:t(()=>[e(k,{value:u(s).pass,"onUpdate:value":a[3]||(a[3]=l=>u(s).pass=l)},{prefix:t(()=>[e(u(F),{class:"site-form-item-icon"})]),_:1},8,["value"])]),_:1}),e(o,{label:"\u518D\u6B21\u8F93\u5165\u5BC6\u7801",name:"password",rules:[{required:!0,validator:u(w),trigger:"blur"}]},{default:t(()=>[e(k,{value:u(s).password,"onUpdate:value":a[4]||(a[4]=l=>u(s).password=l)},{prefix:t(()=>[e(u(F),{class:"site-form-item-icon"})]),_:1},8,["value"])]),_:1},8,["rules"]),e(o,{label:"\u8EAB\u4EFD\u89D2\u8272"},{default:t(()=>[e(B,{value:u(s).role,"onUpdate:value":a[5]||(a[5]=l=>u(s).role=l)},{default:t(()=>[e(v,{value:"admin"},{default:t(()=>[re]),_:1}),e(v,{value:"user"},{default:t(()=>[ie]),_:1})]),_:1},8,["value"])]),_:1}),e(o,{label:"\u72B6\u6001"},{default:t(()=>[e(B,{onChange:U,value:u(n),"onUpdate:value":a[6]||(a[6]=l=>S(n)?n.value=l:n=l)},{default:t(()=>[e(v,{value:"true"},{default:t(()=>[de]),_:1}),e(v,{value:"false"},{default:t(()=>[me]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","ok-button-props"])]),_("div",null,[e(A,{visible:u(p).edit,"onUpdate:visible":a[15]||(a[15]=l=>u(p).edit=l),title:"\u4FEE\u6539\u7528\u6237\u4FE1\u606F",onOk:a[16]||(a[16]=l=>z(u(y),u(s))),afterClose:E,"ok-button-props":{disabled:u(c)}},{default:t(()=>[e(x,{model:u(s)},{default:t(()=>[e(o,{label:"username",name:"username",rules:[{min:3,max:10,message:"\u7528\u6237\u540D\u957F\u5EA63-10"},{}]},{default:t(()=>[e(C,{value:u(s).username,"onUpdate:value":a[9]||(a[9]=l=>u(s).username=l)},{prefix:t(()=>[e(u(I),{class:"site-form-item-icon"})]),_:1},8,["value"])]),_:1}),e(o,{label:"\u8F93\u5165\u5BC6\u7801",name:"pass",rules:[{min:3,max:10,message:"\u5BC6\u7801\u957F\u5EA63-10"}]},{default:t(()=>[e(k,{value:u(s).pass,"onUpdate:value":a[10]||(a[10]=l=>u(s).pass=l)},{prefix:t(()=>[e(u(F),{class:"site-form-item-icon"})]),_:1},8,["value"])]),_:1}),e(o,{label:"\u518D\u6B21\u8F93\u5165\u5BC6\u7801",name:"password",rules:[{validator:u(w),trigger:"blur"}]},{default:t(()=>[e(k,{value:u(s).password,"onUpdate:value":a[11]||(a[11]=l=>u(s).password=l)},{prefix:t(()=>[e(u(F),{class:"site-form-item-icon"})]),_:1},8,["value"])]),_:1},8,["rules"]),e(o,{label:"\u8EAB\u4EFD\u89D2\u8272"},{default:t(()=>[e(B,{value:u(s).role,"onUpdate:value":a[12]||(a[12]=l=>u(s).role=l)},{default:t(()=>[e(v,{value:"admin"},{default:t(()=>[pe]),_:1}),e(v,{value:"user"},{default:t(()=>[ve]),_:1})]),_:1},8,["value"])]),_:1}),e(o,{label:"\u72B6\u6001"},{default:t(()=>[e(B,{onChange:U,value:u(n),"onUpdate:value":a[13]||(a[13]=l=>S(n)?n.value=l:n=l)},{default:t(()=>[e(v,{value:"true"},{default:t(()=>[_e]),_:1}),e(v,{value:"false"},{default:t(()=>[fe]),_:1})]),_:1},8,["value"])]),_:1}),e(o,null,{default:t(()=>[e(J,{value:u(s).promiss,"onUpdate:value":a[14]||(a[14]=l=>u(s).promiss=l),style:{width:"100%"},options:u(D)},null,8,["value","options"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","ok-button-props"])])])}}});export{Ee as default};
