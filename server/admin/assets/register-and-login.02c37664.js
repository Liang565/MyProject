import{a as p}from"./admin-store.d62c6d54.js";import{u as v,p as t,m as a,q as w}from"./vendor.fd5a6943.js";import{h as r}from"./http.2f7338bd.js";const A=()=>{const l=v();let u=t(!1),s=t({username:"",password:"",pass:""});const n=()=>{console.log("\u6267\u884Cregister"),u.value=!0},c=async()=>{let e=t({username:s.value.username,password:s.value.password,role:"2",state:!0});await r.post("auth/register",e.value),a.success("\u6CE8\u518C\u6210\u529F"),o.value.username=s.value.username,u.value=!1},g=()=>{console.log("RegisterOk"),s.value.password==""||s.value.username==""?a.error("\u8D26\u53F7\u6216\u8005\u5BC6\u7801\u4E3A\u7A7A"):c()};let o=t({username:"",password:""});const m=async()=>{console.log("\u6267\u884CloginUser");const e=await r.post("auth/login",o.value);a.success("\u767B\u9646\u6210\u529F"),localStorage.setItem("token",e.token),l.push("/home")},i=()=>{console.log("\u6267\u884ClogOut"),a.success("\u9000\u51FA"),localStorage.removeItem("token"),localStorage.removeItem("userid"),l.push("/login")},d=w(()=>!(o.value.username&&o.value.password));return{RegisterUser:n,regModel:s,LoginUser:m,logModel:o,registerVisibel:u,LogOut:i,RegisterSub:g,disabled:d,getUser:async()=>{const e=await r.get("auth/user");p.setAdmin(e),localStorage.setItem("userid",e._id),localStorage.setItem("role",e.role),localStorage.setItem("username",e.username)}}};export{A as R};
