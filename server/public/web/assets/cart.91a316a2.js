import{d as O,u as P,r as _,p as Q,o as X,a as Y,b as h,c as s,e as d,f as t,h as e,g as n,q as u,t as f,k as g,w as a,i as Z,s as ee,n as y,F as te,j as oe,v as V,T as w}from"./index.a2b7da65.js";import{C as se}from"./curd.2f4c976f.js";/* empty css             *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{h as z}from"./http.2fe81874.js";/* empty css              *//* empty css              */import{_ as v}from"./iconPark.92e86b75.js";/* empty css              */const le={class:"flex justify-between mb-5 ml-5 mt-2"},ne={class:"flex w-16"},ie={key:0,class:"mr-2"},ue={key:1},ae={class:"text-xl"},re={class:"w-16 h-7"},ce={key:1},de={class:"m-4 pb-11"},me={class:"w-80vw mb-2"},_e={class:"text-xl"},pe={class:"flex"},he=t("div",{class:"text-sm mt-1"},"\u5168\u9009",-1),fe={key:0,class:"flex items-center mx-2"},ve={class:"text-sm"},ke=y(" \u5408\u8BA1\uFF1A "),ge=t("span",{class:"text-sm text-red-500"}," \uFFE5 ",-1),ye={class:"text-xl text-red-500"},be={class:"ml-3"},xe=y("\u7ED3\u7B97"),Ce={key:1,class:"flex items-center"},we=y(" \u5DF2\u9009\uFF1A"),Fe={class:"mx-2"},Ne=y("\u5220\u9664"),Re=O({__name:"cart",setup(De){const F=P();let k=_(!1);const{fetch:b,search:Le,data:N,query:x,goGoods:B,total:E,totalSum:$,removeCart:D}=se("shopping-cart"),S=async i=>{i.goodsNum===1?w.fail("\u5546\u54C1\u4E0D\u80FD\u518D\u51CF\u5C11\u4E86~"):(w.loading({message:"\u52A0\u8F7D\u4E2D...",forbidClick:!0,duration:500}),z.put(`shopping-cart/${i._id}`,{goodsNum:i.goodsNum-1}),setTimeout(()=>{x.value.where={user:localStorage.getItem("userid")},b()},500))},T=async i=>{w.loading({message:"\u52A0\u8F7D\u4E2D...",forbidClick:!0,duration:500}),z.put(`shopping-cart/${i._id}`,{goodsNum:i.goodsNum+1}),setTimeout(()=>{x.value.where={user:localStorage.getItem("userid")},b()},500)},G=()=>{F.go(-2)},W=()=>{F.push("/")};let m=_(!0);const I=()=>{m.value=!m.value};let l=_([]),r=_(!1);const L=_();let A=_(0);const q=()=>{r.value=!r.value,L.value.toggleAll(r.value)};Q(l,(i,p)=>{$(l.value).then(c=>{A.value=c}),l.value.length==N.value.length?r.value=!0:r.value=!1});let R="flex justify-between items-center pl-3 p-3 w-full fixed bottom-12 bg-white",M="flex justify-between items-center pl-3 p-3 w-full fixed bottom-0 bg-white",j=localStorage.getItem("userid");return X(()=>{x.value.where={user:localStorage.getItem("userid")},b(),Y().meta.key=="cart1"&&(k.value=!0)}),(i,p)=>{const c=h("van-button"),U=h("van-card"),H=h("van-swipe-cell"),J=h("van-checkbox"),K=h("van-checkbox-group");return s(),d("div",null,[t("div",le,[t("div",ne,[e(k)?(s(),d("div",ie,[t("button",{onClick:G},[n(v,{type:"back",theme:"outline",size:"24",spin:!1,fill:"#000000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})])])):u("",!0),e(k)?(s(),d("div",ue,[t("button",{onClick:W},[n(v,{type:"home",theme:"outline",size:"24",spin:!1,fill:"#000000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})])])):u("",!0)]),t("div",ae,"\u8D2D\u7269\u8F66("+f(e(E))+")",1),t("div",re,[t("button",{onClick:I},[e(m)?(s(),g(v,{key:0,type:"edit-two",theme:"outline",size:"24",spin:!1,fill:"#000000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})):u("",!0),e(m)?u("",!0):(s(),d("span",ce,"\u5B8C\u6210"))])])]),t("div",de,[n(K,{modelValue:e(l),"onUpdate:modelValue":p[0]||(p[0]=o=>Z(l)?l.value=o:l=o),ref_key:"checkboxGroup",ref:L},{default:a(()=>[(s(!0),d(te,null,oe(e(N),o=>(s(),g(J,{name:o._id},{default:a(()=>[t("div",me,[n(H,null,{right:a(()=>[n(c,{square:"",text:"\u5220\u9664",type:"danger",class:"delete-button",onClick:C=>e(D)([o._id],e(j))},null,8,["onClick"])]),default:a(()=>[n(U,{num:o.goodsNum,price:o.goodsNum*o.commodity.price,desc:o.commodity._id,thumb:o.commodity.image[0].url,onClick:C=>e(B)(o.commodity)},{title:a(()=>[t("div",_e,f(o.commodity.commodityName),1)]),footer:a(()=>[n(c,{size:"small",icon:"minus",color:"rgb(59, 130, 246)",onClick:V(C=>S(o),["stop"])},null,8,["onClick"]),n(c,{size:"small",icon:"plus",color:"rgb(59, 130, 246)",onClick:V(C=>T(o),["stop"])},null,8,["onClick"])]),_:2},1032,["num","price","desc","thumb","onClick"])]),_:2},1024)])]),_:2},1032,["name"]))),256))]),_:1},8,["modelValue"])]),t("div",{class:ee(e(k)?e(M):e(R))},[t("div",null,[t("button",{onClick:q},[t("div",pe,[e(r)?u("",!0):(s(),g(v,{key:0,type:"full-selection",theme:"outline",size:"24",spin:!1,fill:"#000000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})),e(r)?(s(),g(v,{key:1,type:"full-selection",theme:"filled",size:"24",spin:!1,fill:"#4a90e2",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})):u("",!0),he])])]),e(m)?(s(),d("div",fe,[t("div",null,[t("span",ve," \u5DF2\u9009\uFF1A"+f(e(l).length),1),ke,ge,t("span",ye,f(e(A)),1)]),t("div",be,[n(c,{round:"",type:"primary"},{default:a(()=>[xe]),_:1})])])):u("",!0),e(m)?u("",!0):(s(),d("div",Ce,[t("div",null,[we,t("span",null,f(e(l).length),1)]),t("div",Fe,[n(c,{round:"",type:"primary",onClick:p[1]||(p[1]=o=>e(D)(e(l),e(j)))},{default:a(()=>[Ne]),_:1})])]))],2)])}}});export{Re as default};
