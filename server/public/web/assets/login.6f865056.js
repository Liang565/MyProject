import{h as _}from"./http.1bb77432.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import{d as V,u as z,r as v,b as d,c as S,e as j,f as i,g as a,w as r,h as o,i as q,x as c,T as f}from"./index.9f384a20.js";import{_ as w}from"./iconPark.3f948dba.js";const E={id:"building"},A={class:"flex justify-center items-center text-4xl pb-10"},R=c(" \u767B\u5F55 "),U={class:"pb-24"},I={style:{margin:"16px"}},L=c(" \u63D0\u4EA4 "),T={class:"flex items-center justify-end pr-5"},M=c(" \u65E0\u8D26\u53F7\uFF1F "),N=c("\u70B9\u51FB\u6CE8\u518C"),W={class:"h-50vh"},G={style:{margin:"16px"}},H=c(" \u63D0\u4EA4 "),$=V({__name:"login",setup(J){const x=z();let u=v({username:"",password:""});const y=async()=>{const t=await _.post("auth/login",u.value);t&&(f.success("\u767B\u9646\u6210\u529F"),localStorage.setItem("token",t.token),setTimeout(()=>{x.push("/")},1e3)),B()},B=async()=>{const t=await _.get("auth/user");localStorage.setItem("userid",t._id),localStorage.setItem("username",t.username),localStorage.setItem("image",t.image),localStorage.setItem("role",t.role)};let l=v(!1),s=v({username:"",password:""});const k=()=>{l.value=!0},C=async()=>{let t=v({username:s.value.username,password:s.value.password,role:"user",state:!0});const e=await _.post("auth/register",t.value);e?(f.success("\u6CE8\u518C\u6210\u529F~"),l.value=!1,u.value.username=e.username):g()},g=()=>{s.value={username:"",password:""}};return(t,e)=>{const p=d("van-field"),b=d("van-cell-group"),m=d("van-button"),h=d("van-form"),F=d("van-notice-bar"),D=d("van-action-sheet");return S(),j("div",E,[i("div",A,[a(w,{type:"smiling-face-with-squinting-eyes",theme:"outline",size:"44",spin:!1,fill:"#000000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2}),R,a(w,{type:"smiling-face-with-squinting-eyes",theme:"outline",size:"44",spin:!1,fill:"#000000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})]),i("div",U,[a(h,{onSubmit:y},{default:r(()=>[a(b,{inset:""},{default:r(()=>[a(p,{modelValue:o(u).username,"onUpdate:modelValue":e[0]||(e[0]=n=>o(u).username=n),name:"\u7528\u6237\u540D",label:"\u7528\u6237\u540D",placeholder:"\u7528\u6237\u540D",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u7528\u6237\u540D"}]},null,8,["modelValue"]),a(p,{modelValue:o(u).password,"onUpdate:modelValue":e[1]||(e[1]=n=>o(u).password=n),type:"password",name:"\u5BC6\u7801",label:"\u5BC6\u7801",placeholder:"\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u5BC6\u7801"}]},null,8,["modelValue"])]),_:1}),i("div",I,[a(m,{round:"",block:"",type:"primary","native-type":"submit",onClick:e[2]||(e[2]=()=>{})},{default:r(()=>[L]),_:1})])]),_:1}),i("div",T,[M,a(m,{color:"#000000",size:"mini",square:"",hairline:"",onClick:k},{default:r(()=>[N]),_:1})])]),i("div",null,[a(F,{scrollable:"","left-icon":"volume-o",text:"\u63D0\u793A\uFF1A\u7528\u6237\u540D\uFF1Auser,\u5BC6\u7801\uFF1Auser "})]),i("div",null,[a(D,{show:o(l),"onUpdate:show":e[5]||(e[5]=n=>q(l)?l.value=n:l=n),"cancel-text":"\u53D6\u6D88",title:"\u6CE8\u518C","close-on-click-action":"",onClose:g},{default:r(()=>[i("div",W,[a(h,{onSubmit:C},{default:r(()=>[a(b,{inset:""},{default:r(()=>[a(p,{modelValue:o(s).username,"onUpdate:modelValue":e[3]||(e[3]=n=>o(s).username=n),name:"\u7528\u6237\u540D",label:"\u7528\u6237\u540D",placeholder:"\u7528\u6237\u540D",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u7528\u6237\u540D"}]},null,8,["modelValue"]),a(p,{modelValue:o(s).password,"onUpdate:modelValue":e[4]||(e[4]=n=>o(s).password=n),type:"password",name:"\u5BC6\u7801",label:"\u5BC6\u7801",placeholder:"\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u5BC6\u7801"}]},null,8,["modelValue"])]),_:1}),i("div",G,[a(m,{round:"",block:"",type:"primary","native-type":"submit"},{default:r(()=>[H]),_:1})])]),_:1})])]),_:1},8,["show"])])])}}});export{$ as default};
