import{d as X,u as Y,r as m,p as Z,o as ee,a as te,b as v,c as s,e as _,f as t,h as e,g as l,q as i,t as k,k as x,w as a,i as V,s as oe,n as C,T as g,F as se,j as le,v as z}from"./index.bc123074.js";import{C as ue}from"./curd.09cee783.js";/* empty css             *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{h as $}from"./http.e29457af.js";/* empty css              *//* empty css              */import{_ as y}from"./iconPark.c9ac1e71.js";import{_ as ne}from"./loginDialog.fb4f876b.js";/* empty css              */const ie={class:"flex justify-between mb-5 ml-5 mt-2"},ae={class:"flex w-16"},re={key:0,class:"mr-2"},ce={key:1},de={class:"text-xl"},me={class:"w-16 h-7"},_e={key:1},pe={class:"m-4 pb-11"},he={class:"w-80vw mb-2"},fe={class:"text-xl"},ve={class:"flex"},ke=t("div",{class:"text-sm mt-1"},"\u5168\u9009",-1),ge={key:0,class:"flex items-center mx-2"},ye={class:"text-sm"},be=C(" \u5408\u8BA1\uFF1A "),xe=t("span",{class:"text-sm text-red-500"}," \uFFE5 ",-1),Ce={class:"text-xl text-red-500"},Fe={class:"ml-3"},we=C("\u7ED3\u7B97"),De={key:1,class:"flex items-center"},Ae=C(" \u5DF2\u9009\uFF1A"),Be={class:"mx-2"},Ee=C("\u5220\u9664"),Je=X({__name:"cart",setup(Ne){let F=localStorage.getItem("token");const B=Y();let b=m(!1);const{fetch:w,search:Le,data:E,query:D,goGoods:T,total:G,totalSum:W,removeCart:N}=ue("shopping-cart"),S=async n=>{n.goodsNum===1?g.fail("\u5546\u54C1\u4E0D\u80FD\u518D\u51CF\u5C11\u4E86~"):(g.loading({message:"\u52A0\u8F7D\u4E2D...",forbidClick:!0,duration:500}),$.put(`shopping-cart/${n._id}`,{goodsNum:n.goodsNum-1}),setTimeout(()=>{D.value.where={user:h},w()},500))},q=async n=>{g.loading({message:"\u52A0\u8F7D\u4E2D...",forbidClick:!0,duration:500}),$.put(`shopping-cart/${n._id}`,{goodsNum:n.goodsNum+1}),setTimeout(()=>{D.value.where={user:h},w()},500)},R=()=>{B.go(-2)},U=()=>{B.push("/")};let p=m(!0);const I=()=>{F?p.value=!p.value:g.fail("\u5F53\u524D\u8EAB\u4EFD\u4E3A\u6E38\u5BA2\uFF0C\u8BF7\u767B\u5F55\uFF01")};let u=m([]),r=m(!1);const L=m();let j=m(0);const M=()=>{F?(r.value=!r.value,L.value.toggleAll(r.value)):g.fail("\u5F53\u524D\u8EAB\u4EFD\u4E3A\u6E38\u5BA2\uFF0C\u8BF7\u767B\u5F55\uFF01")};Z(u,(n,c)=>{W(u.value).then(d=>{j.value=d}),u.value.length==E.value.length?r.value=!0:r.value=!1});let H="flex justify-between items-center pl-3 p-3 w-full fixed bottom-12 bg-white",J="flex justify-between items-center pl-3 p-3 w-full fixed bottom-0 bg-white",h=localStorage.getItem("userid"),f=m(!1);return ee(()=>{F?(D.value.where={user:h},w(),te().meta.key=="cart1"&&(b.value=!0)):f.value=!0}),(n,c)=>{const d=v("van-button"),K=v("van-card"),O=v("van-swipe-cell"),P=v("van-checkbox"),Q=v("van-checkbox-group");return s(),_("div",null,[t("div",ie,[t("div",ae,[e(b)?(s(),_("div",re,[t("button",{onClick:R},[l(y,{type:"back",theme:"outline",size:"24",spin:!1,fill:"#000000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})])])):i("",!0),e(b)?(s(),_("div",ce,[t("button",{onClick:U},[l(y,{type:"home",theme:"outline",size:"24",spin:!1,fill:"#000000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})])])):i("",!0)]),t("div",de,"\u8D2D\u7269\u8F66("+k(e(G))+")",1),t("div",me,[t("button",{onClick:I},[e(p)?(s(),x(y,{key:0,type:"edit-two",theme:"outline",size:"24",spin:!1,fill:"#000000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})):i("",!0),e(p)?i("",!0):(s(),_("span",_e,"\u5B8C\u6210"))])])]),t("div",pe,[l(Q,{modelValue:e(u),"onUpdate:modelValue":c[0]||(c[0]=o=>V(u)?u.value=o:u=o),ref_key:"checkboxGroup",ref:L},{default:a(()=>[(s(!0),_(se,null,le(e(E),o=>(s(),x(P,{name:o._id},{default:a(()=>[t("div",he,[l(O,null,{right:a(()=>[l(d,{square:"",text:"\u5220\u9664",type:"danger",class:"delete-button",onClick:A=>e(N)([o._id],e(h))},null,8,["onClick"])]),default:a(()=>[l(K,{num:o.goodsNum,price:o.goodsNum*o.commodity.price,desc:o.commodity._id,thumb:o.commodity.image[0].url,onClick:A=>e(T)(o.commodity)},{title:a(()=>[t("div",fe,k(o.commodity.commodityName),1)]),footer:a(()=>[l(d,{size:"small",icon:"minus",color:"rgb(59, 130, 246)",onClick:z(A=>S(o),["stop"])},null,8,["onClick"]),l(d,{size:"small",icon:"plus",color:"rgb(59, 130, 246)",onClick:z(A=>q(o),["stop"])},null,8,["onClick"])]),_:2},1032,["num","price","desc","thumb","onClick"])]),_:2},1024)])]),_:2},1032,["name"]))),256))]),_:1},8,["modelValue"])]),t("div",{class:oe(e(b)?e(J):e(H))},[t("div",null,[t("button",{onClick:M},[t("div",ve,[e(r)?i("",!0):(s(),x(y,{key:0,type:"full-selection",theme:"outline",size:"24",spin:!1,fill:"#000000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})),e(r)?(s(),x(y,{key:1,type:"full-selection",theme:"filled",size:"24",spin:!1,fill:"#4a90e2",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})):i("",!0),ke])])]),e(p)?(s(),_("div",ge,[t("div",null,[t("span",ye," \u5DF2\u9009\uFF1A"+k(e(u).length),1),be,xe,t("span",Ce,k(e(j)),1)]),t("div",Fe,[l(d,{round:"",type:"primary"},{default:a(()=>[we]),_:1})])])):i("",!0),e(p)?i("",!0):(s(),_("div",De,[t("div",null,[Ae,t("span",null,k(e(u).length),1)]),t("div",Be,[l(d,{round:"",type:"primary",onClick:c[1]||(c[1]=o=>e(N)(e(u),e(h)))},{default:a(()=>[Ee]),_:1})])]))],2),t("div",null,[l(ne,{showDialog:e(f),"onUpdate:showDialog":c[2]||(c[2]=o=>V(f)?f.value=o:f=o)},null,8,["showDialog"])])])}}});export{Je as default};
