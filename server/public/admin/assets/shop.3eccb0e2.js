import{d as V,g as m,r as p,o as y,j as U,p as o,l as e,x as Q,k as l,w as n,n as W,F as j,h as X,m as Y,t as Z,y as A}from"./vendor.bebcfb65.js";import{a as h}from"./api.85fdd14d.js";import"./http.47838019.js";import{C as ee}from"./crud-api.bf7f3228.js";import{_ as N}from"./upload.79d8c00f.js";import"./register-and-login.befb8532.js";import"./admin-store.b6bbf792.js";/* empty css                                               */const le={class:"aaaaa"},te=["src"],ue=o("span",null,"\u6D4F\u89C8",-1),ae=[ue],ne=o("div",null,null,-1),oe={key:0,class:"tuku"},se={class:"main"},ie=["src"],de=V({props:{URL:String},setup(S){const c=S;let i=m(!0);const E=()=>{i.value=!1},D=()=>{i.value=!0};let _=m(!1);const x=()=>{console.log("looooook"),_.value=!0};return m(!1),(T,d)=>{const C=p("a-modal");return y(),U(j,null,[o("div",le,[o("div",{onMouseenter:E,onMouseleave:D,class:"fa"},[o("img",{src:c.URL,class:"imgimg"},null,8,te),e(i)?Q("",!0):(y(),U("button",{key:0,class:"aaa",onClick:x},ae))],32)]),l(C,{visible:e(_),"onUpdate:visible":d[0]||(d[0]=b=>W(_)?_.value=b:_=b),width:"100%",style:{top:"0px"}},{footer:n(()=>[ne]),default:n(()=>[(y(),U("div",oe,[o("div",se,[o("img",{src:c.URL,alt:"",class:"imgMain"},null,8,ie)])]))]),_:1},8,["visible"])],64)}}}),re={class:"mb-2 flex justify-start"},pe=A(" \u65B0\u589E\u5546\u94FA "),ve={class:"w-full ml-8"},me=A("\u641C\u7D22"),_e={class:"mt-5 h-70vh overflow-y-auto"},fe=A("\u4FEE\u6539"),ge=A("\u5220\u9664"),Ee=V({setup(S){const{remove:c,viss:i,editOk:E,addOk:D,fetch:_,data:x,query:T,where:d,search:C,pagination:b,pageChange:q}=ee("shops");let K=m("addShop");d.value={title:"",user:""};const w=localStorage.getItem("role"),B=localStorage.getItem("userid");w==="admin"?d.value={title:"",user:""}:d.value={title:"",user:B};let a=m({title:"",user:B,description:"",images:"",address:"",phone:""});const z=()=>{a.value={title:"",user:a.value.user,description:"",images:"",address:"",phone:""}},G=()=>{i.value.add=!0};let O=m(!1),g=m([]);const H=async()=>{if(w==="admin"){const f=await h.user.find({limit:999});g.value=f.data.map(t=>({label:t.username,value:t._id})),O.value=!0}else g.value=[{label:localStorage.getItem("username"),value:B}]},M=()=>{z(),console.log("cancel")};let R=m("");const J=f=>{for(let t in a.value)a.value[t]=f[t];a.value.user=f.user._id,R.value=f._id,i.value.edit=!0};return X(()=>{C(),H(),w=="admin"&&Y.info("\u5F53\u524D\u4E3A\u7BA1\u7406\u5458\u7528\u6237")}),(f,t)=>{const k=p("a-button"),r=p("a-input"),s=p("a-form-item"),I=p("a-select"),$=p("a-form"),v=p("a-table-column"),P=p("a-table"),L=p("a-modal");return y(),U(j,null,[o("div",null,[o("div",re,[o("div",null,[l(k,{onClick:G,type:"primary"},{default:n(()=>[pe]),_:1})]),o("div",ve,[l($,{layout:"inline"},{default:n(()=>[l(s,{label:"\u5E97\u94FA\u540D\uFF1A",class:"w-52"},{default:n(()=>[l(r,{value:e(d).title,"onUpdate:value":t[0]||(t[0]=u=>e(d).title=u)},null,8,["value"])]),_:1}),l(s,{label:"\u6240\u5C5E\u7528\u6237\u540D",class:"w-44"},{default:n(()=>[l(I,{options:e(g),value:e(d).user,"onUpdate:value":t[1]||(t[1]=u=>e(d).user=u),allowClear:e(O)},null,8,["options","value","allowClear"])]),_:1}),l(s,null,{default:n(()=>[l(k,{type:"primary",onClick:e(C)},{default:n(()=>[me]),_:1},8,["onClick"])]),_:1})]),_:1})])]),o("div",_e,[l(P,{dataSource:e(x),rowKey:"title",pagination:e(b),onChange:e(q)},{default:n(()=>[l(v,{title:"\u5546\u94FA\u540D",dataIndex:"title",key:"title",class:"w-60",align:"center"}),l(v,{title:"id",dataIndex:"_id",key:"_id",align:"center"}),l(v,{title:"\u6240\u5C5E\u7528\u6237",dataIndex:"user",key:"user",align:"center"},{default:n(({record:u})=>{var F;return[o("span",null,Z((F=u.user)==null?void 0:F.username),1)]}),_:1}),l(v,{title:"\u5546\u94FA\u7B80\u4ECB",dataIndex:"description",key:"description",align:"center"}),l(v,{title:"\u5546\u94FA\u5934\u50CF",dataIndex:"images",key:"images",align:"center"},{default:n(({record:u})=>[l(de,{URL:u.images},null,8,["URL"])]),_:1}),l(v,{title:"\u5546\u94FA\u5730\u5740",dataIndex:"address",key:"address",align:"center"}),l(v,{title:"\u5546\u94FA\u7535\u8BDD",dataIndex:"phone",key:"phone",align:"center"}),l(v,{title:"\u64CD\u4F5C",dataIndex:"operation",key:"operation",align:"center"},{default:n(({record:u})=>[o("div",null,[l(k,{type:"link",onClick:F=>J(u)},{default:n(()=>[fe]),_:2},1032,["onClick"]),l(k,{type:"link",onClick:F=>e(c)(u,u.title)},{default:n(()=>[ge]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["dataSource","pagination","onChange"])])]),o("div",null,[l(L,{visible:e(i).add,"onUpdate:visible":t[8]||(t[8]=u=>e(i).add=u),title:"\u65B0\u589E\u5546\u94FA",onOk:t[9]||(t[9]=u=>e(D)(e(a),e(K))),afterClose:M,centered:!0},{default:n(()=>[l($,{model:e(a)},{default:n(()=>[l(s,{label:"\u5546\u5E97\u540D"},{default:n(()=>[l(r,{value:e(a).title,"onUpdate:value":t[2]||(t[2]=u=>e(a).title=u)},null,8,["value"])]),_:1}),l(s,{label:"\u6240\u5C5E\u7528\u6237\u540D"},{default:n(()=>[l(I,{options:e(g),value:e(a).user,"onUpdate:value":t[3]||(t[3]=u=>e(a).user=u)},null,8,["options","value"])]),_:1}),l(s,{label:"\u5546\u94FA\u7B80\u4ECB"},{default:n(()=>[l(r,{value:e(a).description,"onUpdate:value":t[4]||(t[4]=u=>e(a).description=u)},null,8,["value"])]),_:1}),l(s,{label:"\u5546\u94FA\u5934\u50CF"},{default:n(()=>[l(N,{imageUrl:e(a).images,onOnSuccess:t[5]||(t[5]=u=>{e(a).images=u})},null,8,["imageUrl"])]),_:1}),l(s,{label:"\u5546\u94FA\u5730\u5740"},{default:n(()=>[l(r,{value:e(a).address,"onUpdate:value":t[6]||(t[6]=u=>e(a).address=u)},null,8,["value"])]),_:1}),l(s,{label:"\u5546\u94FA\u7535\u8BDD"},{default:n(()=>[l(r,{value:e(a).phone,"onUpdate:value":t[7]||(t[7]=u=>e(a).phone=u)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])]),o("div",null,[l(L,{visible:e(i).edit,"onUpdate:visible":t[17]||(t[17]=u=>e(i).edit=u),title:"\u4FEE\u6539\u4FE1\u606F",afterClose:M,onOk:t[18]||(t[18]=u=>e(E)(e(R),e(a))),centered:!0},{default:n(()=>[l($,{model:e(a)},{default:n(()=>[l(s,{label:"\u5546\u5E97\u540D"},{default:n(()=>[l(r,{value:e(a).title,"onUpdate:value":t[10]||(t[10]=u=>e(a).title=u)},null,8,["value"])]),_:1}),l(s,{label:"\u6240\u5C5E\u7528\u6237\u540D"},{default:n(()=>[l(I,{options:e(g),value:e(a).user,"onUpdate:value":t[11]||(t[11]=u=>e(a).user=u)},null,8,["options","value"])]),_:1}),l(s,{label:"\u5546\u94FA\u7B80\u4ECB"},{default:n(()=>[l(r,{value:e(a).description,"onUpdate:value":t[12]||(t[12]=u=>e(a).description=u)},null,8,["value"])]),_:1}),l(s,{label:"\u5546\u94FA\u5934\u50CF"},{default:n(()=>[l(N,{imageUrl:e(a).images,"onUpdate:imageUrl":t[13]||(t[13]=u=>e(a).images=u),onOnSuccess:t[14]||(t[14]=u=>{e(a).images=u})},null,8,["imageUrl"])]),_:1}),l(s,{label:"\u5546\u94FA\u5730\u5740"},{default:n(()=>[l(r,{value:e(a).address,"onUpdate:value":t[15]||(t[15]=u=>e(a).address=u)},null,8,["value"])]),_:1}),l(s,{label:"\u5546\u94FA\u7535\u8BDD"},{default:n(()=>[l(r,{value:e(a).phone,"onUpdate:value":t[16]||(t[16]=u=>e(a).phone=u)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])])],64)}}});export{Ee as default};
