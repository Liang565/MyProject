import{a as m}from"./admin-store.fe4adc91.js";import{u as S,g as r,m as s,z as w}from"./vendor.1e3ef9c3.js";import{h as u}from"./http.3d895303.js";const A=()=>{const l=S();let o=r(!1),t=r({username:"",password:"",pass:""});const i=()=>{o.value=!0},g=async()=>{let e=r({username:t.value.username,password:t.value.password,role:"user",state:!0});await u.post("auth/register",e.value),s.success("\u6CE8\u518C\u6210\u529F"),a.value.username=t.value.username,o.value=!1},c=()=>{t.value.password==""||t.value.username==""?s.error("\u8D26\u53F7\u6216\u8005\u5BC6\u7801\u4E3A\u7A7A"):g()};let a=r({username:"",password:""});const d=async()=>{const e=await u.post("auth/login",a.value);e===""?(s.warning("\u767B\u9646\u5931\u8D25"),s.warning("\u8BF7\u91CD\u65B0\u5C1D\u8BD5")):(s.success("\u767B\u9646\u6210\u529F"),localStorage.setItem("token",e.token),setTimeout(()=>{l.push("/")},500),n())},p=()=>{s.success("\u9000\u51FA"),localStorage.removeItem("token"),localStorage.removeItem("userid"),localStorage.removeItem("username"),localStorage.removeItem("role"),localStorage.removeItem("promiss"),l.push("/login")},v=w(()=>!(a.value.username&&a.value.password)),n=async()=>{if(localStorage.getItem("adminId")){const e={userid:localStorage.getItem("userid"),role:localStorage.getItem("role"),username:localStorage.getItem("username")};m.setAdmin(e)}else{const e=await u.get("auth/user");m.setAdmin(e),localStorage.setItem("userid",e._id),localStorage.setItem("role",e.role),localStorage.setItem("username",e.username)}};return{RegisterUser:i,regModel:t,LoginUser:d,logModel:a,registerVisibel:o,LogOut:p,RegisterSub:c,disabled:v,getUser:n,httpURL:"http://www.lianger.fit/admin/api/"}};export{A as R};
