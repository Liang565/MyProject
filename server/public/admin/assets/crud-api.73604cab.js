import{h as n}from"./http.ac208b77.js";import{g as s,m as r,L as F,k as d,N as h}from"./vendor.34bbf430.js";const E=i=>{let t=s({total:0,current:1,pageSize:5});const f=e=>{a.value.page=e.current,t.value.current=e.current,u()};let a=s({limit:t.value.pageSize,page:1,where:s({})}),c=s();const u=async()=>{let e=await n.get(`${i}`,{params:{query:a.value}});e.total===0&&r.info("\u6570\u636E\u4E3A\u7A7A"),c.value=e.data,t.value.total=e.total,c.value.length==0&&e.total!=0&&(a.value.page=a.value.page-1,t.value.current=t.value.current-1,u())};let v=s({add:!1,edit:!1,addSon:!1});const p=async(e,l)=>{l?await n.post(`${i}/${l}`,e):await n.post(`${i}`,e),r.success("\u6DFB\u52A0\u6210\u529F"),c.value.length==a.value.limit&&(t.value.total+1)%a.value.limit!=0&&(a.value.page=Math.floor(t.value.total/a.value.limit)+1,t.value.current=a.value.page),v.value.add=!1,u()},g=(e,l)=>{F.confirm({title:"\u662F\u5426\u786E\u8BA4\u5220\u9664\uFF1F",icon:d(h),content:d("div",{style:"color:red"},`\u662F\u5426\u5220\u9664:${l} \u6570\u636E\uFF1F`),async onOk(){await n.delete(`${i}/${e._id}`),r.success("\u5DF2\u5220\u9664"),u()},onCancel(){u()}})},m=async(e,l)=>{await n.put(`${i}/${e}`,l),r.success("\u5DF2\u4FEE\u6539"),u(),v.value.edit=!1};let o=s({});return{remove:g,viss:v,editOk:m,addOk:p,fetch:u,data:c,query:a,where:o,search:()=>{for(let e in o.value)o.value[e]==""&&delete o.value[e];a.value.page<1&&(a.value.page=1),a.value.where=o.value,u()},pagination:t,pageChange:f}};export{E as C};
