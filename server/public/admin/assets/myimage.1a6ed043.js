import{c as C,a as f,i as F,b as N,n as u,t as S,m as P,I as U,w as V}from"./http.0a1d0e7b.js";import{d as D,i as A,j as R,k as T,l as q,f as a,m as O,n as G,p as x,q as H,b as h,c as g,w as z,s as B}from"./user.f5194c42.js";import{V as m,U as k}from"./reactivity.esm-bundler.c1ee0d40.js";const[J,n]=C("image"),K={src:String,alt:String,fit:String,position:String,round:Boolean,width:u,height:u,radius:u,lazyLoad:Boolean,iconSize:u,showError:S,errorIcon:P("photo-fail"),iconPrefix:String,showLoading:S,loadingIcon:P("photo")};var M=D({name:J,props:K,emits:["load","error"],setup(e,{emit:t,slots:i}){const o=m(!1),s=m(!0),l=m(),{$Lazyload:c}=A().proxy,E=R(()=>{const r={width:f(e.width),height:f(e.height)};return F(e.radius)&&(r.overflow="hidden",r.borderRadius=f(e.radius)),r});T(()=>e.src,()=>{o.value=!1,s.value=!0});const v=r=>{s.value=!1,t("load",r)},w=r=>{o.value=!0,s.value=!1,t("error",r)},y=(r,d,L)=>L?L():a(U,{name:r,size:e.iconSize,class:d,classPrefix:e.iconPrefix},null),$=()=>{if(s.value&&e.showLoading)return a("div",{class:n("loading")},[y(e.loadingIcon,n("loading-icon"),i.loading)]);if(o.value&&e.showError)return a("div",{class:n("error")},[y(e.errorIcon,n("error-icon"),i.error)])},j=()=>{if(o.value||!e.src)return;const r={alt:e.alt,class:n("img"),style:{objectFit:e.fit,objectPosition:e.position}};return e.lazyLoad?O(a("img",x({ref:l},r),null),[[G("lazy"),e.src]]):a("img",x({src:e.src,onLoad:v,onError:w},r),null)},_=({el:r})=>{const d=()=>{r===l.value&&s.value&&v()};l.value?d():H(d)},I=({el:r})=>{r===l.value&&!o.value&&w()};return c&&N&&(c.$on("loaded",_),c.$on("error",I),q(()=>{c.$off("loaded",_),c.$off("error",I)})),()=>{var r;return a("div",{class:n({round:e.round}),style:E.value},[j(),$(),(r=i.default)==null?void 0:r.call(i)])}}});const b=V(M),Q={key:0},W=B("\u52A0\u8F7D\u5931\u8D25"),X={key:1},Y=B("\u52A0\u8F7D\u5931\u8D25"),re=D({props:{src:{type:Object,default:""},width:{type:String,default:"60"},height:{type:String,default:"60"},radius:{type:String,default:"0"}},setup(e){const t=e;return(i,o)=>(h(),g("div",null,[t.src.length===0?(h(),g("div",Q,[a(k(b),{src:"",width:"60",height:"60",fit:"contain"},{loading:z(()=>[W]),_:1})])):(h(),g("div",X,[a(k(b),{src:t.src[0].url,width:t.width,height:t.height,radius:t.radius,fit:"contain"},{error:z(()=>[Y]),_:1},8,["src","width","height","radius"])]))]))}});export{re as _};
