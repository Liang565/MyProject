import{d as O,r,o as v,c as R,w as n,k as b,u as e,p as o,h as c,x as Q,l,n as W,F as T,j as X,v as Y,y as $}from"./vendor.d8b6d154.js";import{a as Z}from"./api.32dc1098.js";import"./http.dfe8b96f.js";import{C as ee}from"./crud-api.bfc83400.js";import{R as le}from"./register-and-login.aab1b8e3.js";import"./admin-store.abd45c57.js";const te=["src"],ue={key:1},ae=o("div",{class:"ant-upload-text"},"\u70B9\u51FB\u4E0A\u4F20",-1),j=O({props:{imageUrl:String},emits:["on-success"],setup(k,{emit:f}){const{httpURL:d}=le(),y=(p,F,x)=>{var s;f("on-success",(s=p.file.response)==null?void 0:s.url)},U=()=>!0;return(p,F)=>{const x=r("loading-outlined"),s=r("plus-outlined"),g=r("a-upload");return v(),R(g,{name:"file","list-type":"picture-card","show-upload-list":!1,action:e(d)+"/upload",onChange:y,"before-upload":U},{default:n(()=>[k.imageUrl?(v(),b("img",{key:0,src:k.imageUrl,alt:"avatar"},null,8,te)):(v(),b("div",ue,[p.loading?(v(),R(x,{key:0})):(v(),R(s,{key:1})),ae]))]),_:1},8,["action"])}}});const ne={class:"aaaaa"},oe=["src"],se=o("span",null,"\u6D4F\u89C8",-1),ie=[se],de=o("div",null,null,-1),re={key:0,class:"tuku"},pe={class:"main"},me=["src"],ve=O({props:{URL:String},setup(k){const f=k;let d=c(!0);const y=()=>{d.value=!1},U=()=>{d.value=!0};let p=c(!1);const F=()=>{console.log("looooook"),p.value=!0};return c(!1),(x,s)=>{const g=r("a-modal");return v(),b(T,null,[o("div",ne,[o("div",{onMouseenter:y,onMouseleave:U,class:"fa"},[o("img",{src:f.URL,class:"imgimg"},null,8,oe),e(d)?Q("",!0):(v(),b("button",{key:0,class:"aaa",onClick:F},ie))],32)]),l(g,{visible:e(p),"onUpdate:visible":s[0]||(s[0]=E=>W(p)?p.value=E:p=E),width:"100%",style:{top:"0px"}},{footer:n(()=>[de]),default:n(()=>[(v(),b("div",re,[o("div",pe,[o("img",{src:f.URL,alt:"",class:"imgMain"},null,8,me)])]))]),_:1},8,["visible"])],64)}}}),_e=o("div",{class:"mb-2 text-2xl"},"\u5546\u94FA\u7BA1\u7406",-1),ce={class:"mb-2 flex justify-start"},fe=$(" \u65B0\u589E\u5546\u94FA "),ge={class:"w-full ml-8"},Ce=$("\u641C\u7D22"),be={class:"mt-5"},ke=$("\u4FEE\u6539"),ye=$("\u5220\u9664"),De=O({setup(k){const{remove:f,viss:d,editOk:y,addOk:U,fetch:p,data:F,query:x,where:s,search:g,pagination:E,pageChange:q}=ee("shops");let K=c("addShop");s.value={title:"",user:""};const L=localStorage.getItem("role"),w=localStorage.getItem("userid");L==="admin"?s.value={title:"",user:""}:s.value={title:"",user:w};let a=c({title:"",user:w,description:"",images:"",address:"",phone:""});const z=()=>{a.value={title:"",user:a.value.user,description:"",images:"",address:"",phone:""}},G=()=>{d.value.add=!0};let h=c(!1),A=c([]);const H=async()=>{if(L==="admin"){const C=await Z.user.find({limit:999});A.value=C.data.map(t=>({label:t.username,value:t._id})),h.value=!0}else A.value=[{label:localStorage.getItem("username"),value:w}]},M=()=>{z(),console.log("cancel")};let N=c("");const J=C=>{for(let t in a.value)a.value[t]=C[t];a.value.user=C.user._id,N.value=C._id,d.value.edit=!0};return X(()=>{g(),H()}),(C,t)=>{const B=r("a-button"),m=r("a-input"),i=r("a-form-item"),I=r("a-select"),S=r("a-form"),_=r("a-table-column"),P=r("a-table"),V=r("a-modal");return v(),b(T,null,[o("div",null,[_e,o("div",ce,[o("div",null,[l(B,{onClick:G,type:"primary"},{default:n(()=>[fe]),_:1})]),o("div",ge,[l(S,{layout:"inline"},{default:n(()=>[l(i,{label:"\u5E97\u94FA\u540D\uFF1A",class:"w-52"},{default:n(()=>[l(m,{value:e(s).title,"onUpdate:value":t[0]||(t[0]=u=>e(s).title=u)},null,8,["value"])]),_:1}),l(i,{label:"\u6240\u5C5E\u7528\u6237\u540D",class:"w-44"},{default:n(()=>[l(I,{options:e(A),value:e(s).user,"onUpdate:value":t[1]||(t[1]=u=>e(s).user=u),allowClear:e(h)},null,8,["options","value","allowClear"])]),_:1}),l(i,null,{default:n(()=>[l(B,{type:"primary",onClick:e(g)},{default:n(()=>[Ce]),_:1},8,["onClick"])]),_:1})]),_:1})])]),o("div",be,[l(P,{dataSource:e(F),rowKey:"title",pagination:e(E),onChange:e(q),scroll:{y:395}},{default:n(()=>[l(_,{title:"\u5546\u94FA\u540D",dataIndex:"title",key:"title",class:"w-60",align:"center"}),l(_,{title:"id",dataIndex:"_id",key:"_id",align:"center"}),l(_,{title:"\u6240\u5C5E\u7528\u6237",dataIndex:"user",key:"user",align:"center"},{default:n(({record:u})=>{var D;return[o("span",null,Y((D=u.user)==null?void 0:D.username),1)]}),_:1}),l(_,{title:"\u5546\u94FA\u7B80\u4ECB",dataIndex:"description",key:"description",align:"center"}),l(_,{title:"\u5546\u94FA\u5934\u50CF",dataIndex:"images",key:"images",align:"center"},{default:n(({record:u})=>[l(ve,{URL:u.images},null,8,["URL"])]),_:1}),l(_,{title:"\u5546\u94FA\u5730\u5740",dataIndex:"address",key:"address",align:"center"}),l(_,{title:"\u5546\u94FA\u7535\u8BDD",dataIndex:"phone",key:"phone",align:"center"}),l(_,{title:"\u64CD\u4F5C",dataIndex:"operation",key:"operation",align:"center"},{default:n(({record:u})=>[o("div",null,[l(B,{type:"link",onClick:D=>J(u)},{default:n(()=>[ke]),_:2},1032,["onClick"]),l(B,{type:"link",onClick:D=>e(f)(u,u.title)},{default:n(()=>[ye]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["dataSource","pagination","onChange"])])]),o("div",null,[l(V,{visible:e(d).add,"onUpdate:visible":t[8]||(t[8]=u=>e(d).add=u),title:"\u65B0\u589E\u5546\u94FA",onOk:t[9]||(t[9]=u=>e(U)(e(a),e(K))),afterClose:M,centered:!0},{default:n(()=>[l(S,{model:e(a)},{default:n(()=>[l(i,{label:"\u5546\u5E97\u540D"},{default:n(()=>[l(m,{value:e(a).title,"onUpdate:value":t[2]||(t[2]=u=>e(a).title=u)},null,8,["value"])]),_:1}),l(i,{label:"\u6240\u5C5E\u7528\u6237\u540D"},{default:n(()=>[l(I,{options:e(A),value:e(a).user,"onUpdate:value":t[3]||(t[3]=u=>e(a).user=u)},null,8,["options","value"])]),_:1}),l(i,{label:"\u5546\u94FA\u7B80\u4ECB"},{default:n(()=>[l(m,{value:e(a).description,"onUpdate:value":t[4]||(t[4]=u=>e(a).description=u)},null,8,["value"])]),_:1}),l(i,{label:"\u5546\u94FA\u5934\u50CF"},{default:n(()=>[l(j,{imageUrl:e(a).images,onOnSuccess:t[5]||(t[5]=u=>{e(a).images=u})},null,8,["imageUrl"])]),_:1}),l(i,{label:"\u5546\u94FA\u5730\u5740"},{default:n(()=>[l(m,{value:e(a).address,"onUpdate:value":t[6]||(t[6]=u=>e(a).address=u)},null,8,["value"])]),_:1}),l(i,{label:"\u5546\u94FA\u7535\u8BDD"},{default:n(()=>[l(m,{value:e(a).phone,"onUpdate:value":t[7]||(t[7]=u=>e(a).phone=u)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])]),o("div",null,[l(V,{visible:e(d).edit,"onUpdate:visible":t[17]||(t[17]=u=>e(d).edit=u),title:"\u4FEE\u6539\u4FE1\u606F",afterClose:M,onOk:t[18]||(t[18]=u=>e(y)(e(N),e(a))),centered:!0},{default:n(()=>[l(S,{model:e(a)},{default:n(()=>[l(i,{label:"\u5546\u5E97\u540D"},{default:n(()=>[l(m,{value:e(a).title,"onUpdate:value":t[10]||(t[10]=u=>e(a).title=u)},null,8,["value"])]),_:1}),l(i,{label:"\u6240\u5C5E\u7528\u6237\u540D"},{default:n(()=>[l(I,{options:e(A),value:e(a).user,"onUpdate:value":t[11]||(t[11]=u=>e(a).user=u)},null,8,["options","value"])]),_:1}),l(i,{label:"\u5546\u94FA\u7B80\u4ECB"},{default:n(()=>[l(m,{value:e(a).description,"onUpdate:value":t[12]||(t[12]=u=>e(a).description=u)},null,8,["value"])]),_:1}),l(i,{label:"\u5546\u94FA\u5934\u50CF"},{default:n(()=>[l(j,{imageUrl:e(a).images,"onUpdate:imageUrl":t[13]||(t[13]=u=>e(a).images=u),onOnSuccess:t[14]||(t[14]=u=>{e(a).images=u})},null,8,["imageUrl"])]),_:1}),l(i,{label:"\u5546\u94FA\u5730\u5740"},{default:n(()=>[l(m,{value:e(a).address,"onUpdate:value":t[15]||(t[15]=u=>e(a).address=u)},null,8,["value"])]),_:1}),l(i,{label:"\u5546\u94FA\u7535\u8BDD"},{default:n(()=>[l(m,{value:e(a).phone,"onUpdate:value":t[16]||(t[16]=u=>e(a).phone=u)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])])],64)}}});export{De as default};
