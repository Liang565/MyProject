import{_ as y}from"./index.03bb2250.js";import{h as v}from"./http.72fb258c.js";import{d as O}from"./vuedraggable.umd.f0e2484a.js";import{d as $,g as a,h as N,m as c,r as _,o as f,j as g,p as n,k as l,w as r,F as U,q as j,l as u,n as G,y as b,t as z,c as H,D as J,E as K}from"./vendor.21c9141e.js";function Q(h){switch(h){case"../../components/components/grid.vue":return y(()=>import("./grid.927227a3.js"),["assets/grid.927227a3.js","assets/shopCard.80749229.css","assets/upload.vue_vue_type_style_index_0_lang.93e2bfe0.css","assets/icon.4488182b.js","assets/vendor.21c9141e.js","assets/upload.d8152770.js","assets/register-and-login.ff801dd2.js","assets/admin-store.0a078265.js","assets/http.72fb258c.js"]);case"../../components/components/shopCard.vue":return y(()=>import("./shopCard.58918838.js"),["assets/shopCard.58918838.js","assets/shopCard.80749229.css","assets/upload.vue_vue_type_style_index_0_lang.93e2bfe0.css","assets/admin-store.0a078265.js","assets/vendor.21c9141e.js","assets/http.72fb258c.js"]);case"../../components/components/swipe.vue":return y(()=>import("./swipe.8e17f5db.js"),["assets/swipe.8e17f5db.js","assets/swipe.8a05e310.css","assets/upload.vue_vue_type_style_index_0_lang.93e2bfe0.css","assets/upload.d8152770.js","assets/register-and-login.ff801dd2.js","assets/admin-store.0a078265.js","assets/vendor.21c9141e.js","assets/http.72fb258c.js"]);default:return new Promise(function(w,m){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(m.bind(null,new Error("Unknown variable dynamic import: "+h)))})}}const W={class:"mt-5 flex justify-between"},X=n("div",null,"\u6DFB\u52A0\u7EC4\u4EF6",-1),Y={class:"fixed bottom-50vh"},Z=b("\u4FDD\u5B58"),ee={class:"w-500 h-70vh bg-white overflow-y-auto"},oe=n("div",null,[n("div",{id:"option"},"\u8BBE\u7F6E")],-1),ue=$({setup(h){const w=e=>K(()=>Q(`../../components/components/${e}.vue`));let m=a(),p=a(),t=a({});a();let d=a([]),D=a();const F=localStorage.getItem("userid"),E=localStorage.getItem("role");let s=a(),C=a();const A=e=>{D.value=e.index},V=()=>{for(let e in p.value)if(p.value[e]._id===s.value){t.value=p.value[e];break}k()},R=async()=>{const e=await v.get("components",{params:{query:{limit:999,where:{key:"public"}}}});m.value=e.data},I=async()=>{const e=await v.get("shops",{params:{query:{limit:999,where:{user:F}}}});e.length===0?E==="admin"?c.info("\u5F53\u524D\u4E3A\u7BA1\u7406\u5458\u7528\u6237"):c.info("\u8BE5\u7528\u6237\u4E0B\u65E0\u5E97\u94FA"):(d.value=e.data.map(i=>({label:i.title,value:i._id})),d.value[0].value&&(s.value=d.value[0].value,t.value=e.data[0],k()),p.value=e.data)},S=e=>{e==="grid"?t.value.components.push({name:e,option:{index:Date.now(),column:4},content:{},index:Date.now()}):t.value.components.push({name:e,option:{index:Date.now(),height:356,autoplay:3e3},content:{},index:Date.now()})},q=async e=>{t.value.components.splice(t.value.components.indexOf(e),1)},k=async()=>{const e=await v.get("commoditys",{params:{query:{where:{shop:s.value},limit:999}}});C.value=e.data},M=async()=>{await v.put(`shops/${s.value}`,{components:t.value.components})?c.success("\u4FDD\u5B58\u6210\u529F~"):c.success("\u4FDD\u5B58\u5931\u8D25~")};return N(()=>{E==="admin"?c.info("\u5F53\u524D\u7528\u6237\u4E3A\u7BA1\u7406\u5458\u7528\u6237~"):(R(),I())}),(e,i)=>{const P=_("a-select"),T=_("a-form-item"),L=_("a-form"),x=_("a-button");return f(),g("div",null,[n("div",null,[l(L,{layout:"inline"},{default:r(()=>[l(T,{label:"\u5207\u6362\u5E97\u94FA",class:"w-44"},{default:r(()=>[l(P,{options:u(d),value:u(s),"onUpdate:value":i[0]||(i[0]=o=>G(s)?s.value=o:s=o),onChange:V},null,8,["options","value"])]),_:1})]),_:1})]),n("div",W,[n("div",null,[X,(f(!0),g(U,null,j(u(m),o=>(f(),g("div",null,[l(x,{type:"primary",class:"w-20 my-2",onClick:B=>S(o.title)},{default:r(()=>[b(z(o.name),1)]),_:2},1032,["onClick"])]))),256)),n("div",Y,[l(x,{type:"primary",class:"w-20 my-2",onClick:M},{default:r(()=>[Z]),_:1})])]),n("div",ee,[l(u(O),{modelValue:u(t).components,"onUpdate:modelValue":i[1]||(i[1]=o=>u(t).components=o),group:"people","item-key":"id"},{item:r(({element:o})=>[n("div",null,[(f(),H(J(w(o.name)),{option:o.option,content:o.content,index:u(D),goods:u(C),onClick:B=>A(o),onRemoveComponent:B=>q(o)},null,8,["option","content","index","goods","onClick","onRemoveComponent"]))])]),_:1},8,["modelValue"])]),oe])])}}});export{ue as default};
