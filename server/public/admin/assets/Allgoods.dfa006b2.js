import{f as Q,g as s,P as z,h as H,r,o as E,j as h,p as c,k as e,w as u,l as o,F as J,m as D,t as O,y,L as W,Q as X}from"./vendor.34bbf430.js";import{h as S}from"./http.ac208b77.js";import{C as Y}from"./crud-api.73604cab.js";import{_ as Z,a as ee}from"./myimglist.46eb359f.js";import"./admin-store.bb77b52f.js";import"./user-store.80d0fbbe.js";import"./reactivity.esm-bundler.f180a2dc.js";import"./register-and-login.97fb9136.js";/* empty css                                                  */const te=y("\u641C\u7D22"),ae={class:"mt-5 h-70vh overflow-y-auto"},oe=y("\u67E5\u770B"),le=y("\u67E5\u770B"),ue={key:0},ie={key:1},ne=y("\u4FEE\u6539"),de=y("\u5220\u9664"),Ee=Q({setup(me){const{remove:U,viss:C,editOk:L,addOk:se,fetch:$,data:A,query:re,where:p,search:N,pagination:M,pageChange:V}=Y("commoditys");let f=s(!0);s(!1),s("");const b=localStorage.getItem("role");let g=s([]);const R=async()=>{const i=await S.post(`/commoditys/Goods/${localStorage.userid}`);i.length===0?b==="admin"?D.info("\u5F53\u524D\u4E3A\u7BA1\u7406\u5458\u7528\u6237"):D.error("\u8BE5\u7528\u6237\u4E0B\u65E0\u5E97\u94FA,\u4E0D\u80FD\u65B0\u589E\u5546\u54C1"):(g.value=i.map(a=>({label:a.title,value:a.id})),g.value[0].value&&(p.value.shop=g.value[0].value,l.value.shop=p.value.shop,N()))};s("addShop"),p.value={commodityName:"",title:"",shop:""};let l=s({commodityName:"",commodityIntroduce:"",image:[],title:"",parameter:[],commodityNum:0,price:0,shop:""});const q=()=>{l.value={commodityName:"",commodityIntroduce:"",image:[],title:"",parameter:[],commodityNum:0,price:0,shop:l.value.shop}};let k=s([]);const T=async()=>{const i=await S.get("commodity-class",{params:{query:{limit:999}}});k.value=i.data.map(a=>({label:a.title,value:a._id}))},I=(i,a)=>a.label.toLowerCase().indexOf(i.toLowerCase())>=0,j=()=>{q()};let w=s("");const G=i=>{l.value.image=i.image,l.value.commodityName=i.commodityName,l.value.price=i.price,l.value.commodityIntroduce=i.commodityIntroduce,l.value.title=i.title._id,l.value.parameter=i.parameter,l.value.commodityNum=i.commodityNum,l.value.shop=i.shop,w.value=i._id,C.value.edit=!0,f.value=!f.value};z(f,(i,a)=>{});const F=(i,a)=>{W.info({title:`${a}`,content:X("div",{},`${i}`),onOk(){}})};return H(()=>{T(),R(),b=="admin"&&$()}),(i,a)=>{const v=r("a-input"),n=r("a-form-item"),B=r("a-select"),_=r("a-button"),x=r("a-form"),d=r("a-table-column"),K=r("a-table"),P=r("a-modal");return E(),h(J,null,[c("div",null,[c("div",null,[c("div",null,[e(x,{layout:"inline"},{default:u(()=>[e(n,{label:"\u5546\u54C1\u540D\uFF1A",class:"w-52"},{default:u(()=>[e(v,{value:o(p).commodityName,"onUpdate:value":a[0]||(a[0]=t=>o(p).commodityName=t)},null,8,["value"])]),_:1}),e(n,{label:"\u6240\u5C5E\u5206\u7C7B",class:"w-44"},{default:u(()=>[e(B,{options:o(k),value:o(p).title,"onUpdate:value":a[1]||(a[1]=t=>o(p).title=t),allowClear:!0,showSearch:!0,"filter-Option":I},null,8,["options","value"])]),_:1}),e(n,null,{default:u(()=>[e(_,{type:"primary",onClick:o(N)},{default:u(()=>[te]),_:1},8,["onClick"])]),_:1})]),_:1})])]),c("div",ae,[e(K,{dataSource:o(A),rowKey:"title",pagination:o(M),onChange:o(V)},{default:u(()=>[e(d,{title:"id",dataIndex:"_id",key:"_id",class:"w-40",align:"center"}),e(d,{align:"center",title:"\u5546\u54C1\u540D",dataIndex:"commodityName",key:"commodityName"}),e(d,{title:"\u5546\u54C1\u4ECB\u7ECD",dataIndex:"commodityIntroduce",key:"commodityIntroduce",align:"center"},{default:u(({record:t})=>[e(_,{type:"link",onClick:m=>F(t.commodityIntroduce,"\u5546\u54C1\u4ECB\u7ECD")},{default:u(()=>[oe]),_:2},1032,["onClick"])]),_:1}),e(d,{title:"\u53C2\u6570",dataIndex:"parameter",key:"parameter",align:"center"},{default:u(({record:t})=>[e(_,{type:"link",onClick:m=>F(t.parameter,"\u53C2\u6570")},{default:u(()=>[le]),_:2},1032,["onClick"])]),_:1}),e(d,{align:"center",title:"\u6570\u91CF",dataIndex:"commodityNum",key:"commodityNum"}),e(d,{title:"\u4EF7\u683C",dataIndex:"price",key:"price",align:"center"}),e(d,{title:"\u5206\u7C7B",dataIndex:"title",key:"title",align:"center"},{default:u(({record:t})=>{var m;return[c("span",null,O((m=t.title)==null?void 0:m.title),1)]}),_:1}),e(d,{title:"\u6240\u5C5E\u5546\u94FA",dataIndex:"shop",key:"shop",align:"center"},{default:u(({record:t})=>{var m;return[c("span",null,O((m=t.shop)==null?void 0:m.title),1)]}),_:1}),e(d,{title:"\u56FE\u7247",dataIndex:"image",key:"image",align:"center"},{default:u(({record:t})=>[t.image.length==0?(E(),h("div",ue,"\u7A7A")):(E(),h("div",ie,[e(Z,{URL:t.image},null,8,["URL"])]))]),_:1}),e(d,{title:"\u64CD\u4F5C",dataIndex:"operation",key:"operation",align:"center"},{default:u(({record:t})=>[c("div",null,[e(_,{type:"link",onClick:m=>G(t)},{default:u(()=>[ne]),_:2},1032,["onClick"]),e(_,{type:"link",onClick:m=>o(U)(t,t.title)},{default:u(()=>[de]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["dataSource","pagination","onChange"])])]),c("div",null,[e(P,{visible:o(C).edit,"onUpdate:visible":a[9]||(a[9]=t=>o(C).edit=t),title:"\u4FEE\u6539\u5546\u54C1\u4FE1\u606F",onOk:a[10]||(a[10]=t=>o(L)(o(w),o(l))),afterClose:j,centered:!0},{default:u(()=>[e(x,{model:o(l)},{default:u(()=>[e(n,{label:"\u5546\u54C1\u540D"},{default:u(()=>[e(v,{value:o(l).commodityName,"onUpdate:value":a[2]||(a[2]=t=>o(l).commodityName=t)},null,8,["value"])]),_:1}),e(n,{label:"\u5206\u7C7B"},{default:u(()=>[e(B,{allowClear:!0,showSearch:!0,options:o(k),value:o(l).title,"onUpdate:value":a[3]||(a[3]=t=>o(l).title=t),"filter-Option":I},null,8,["options","value"])]),_:1}),e(n,{label:"\u5546\u54C1\u7B80\u4ECB"},{default:u(()=>[e(v,{value:o(l).commodityIntroduce,"onUpdate:value":a[4]||(a[4]=t=>o(l).commodityIntroduce=t)},null,8,["value"])]),_:1}),e(n,{label:"\u5546\u54C1\u56FE\u7247"},{default:u(()=>[e(ee,{imgList:o(l).image,resetList:o(f),onOnSuccess:a[5]||(a[5]=t=>{o(l).image=t})},null,8,["imgList","resetList"])]),_:1}),e(n,{label:"\u53C2\u6570"},{default:u(()=>[e(v,{value:o(l).parameter,"onUpdate:value":a[6]||(a[6]=t=>o(l).parameter=t)},null,8,["value"])]),_:1}),e(n,{label:"\u6570\u91CF"},{default:u(()=>[e(v,{value:o(l).commodityNum,"onUpdate:value":a[7]||(a[7]=t=>o(l).commodityNum=t)},null,8,["value"])]),_:1}),e(n,{label:"\u4EF7\u683C"},{default:u(()=>[e(v,{value:o(l).price,"onUpdate:value":a[8]||(a[8]=t=>o(l).price=t)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])])],64)}}});export{Ee as default};
