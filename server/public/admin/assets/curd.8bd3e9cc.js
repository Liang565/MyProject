import{u as d}from"./user.d35c86f9.js";import{h as s,T as i}from"./http.f71bceac.js";import{D as h}from"./function-call.15a0f271.js";import{q as r}from"./reactivity.esm-bundler.f180a2dc.js";const E=l=>{const m=d();let c=r(),f=r(),u=r({limit:0,page:1,where:r()});const n=async()=>{const t=await s.get(`/${l}`,{params:{query:u.value}});if(t.total==0)i.fail("\u65E0\u6570\u636E~"),c.value=[];else{const o=JSON.stringify(u.value);m.push({query:{query1:o}}),c.value=t.data,f.value=t.total}};return{fetch:n,search:async()=>{console.log(u),n()},data:c,query:u,goGoods:t=>{m.push(`/goods/${t._id}`)},total:f,totalSum:async t=>{let o=0;for(let a in t){const e=await s.put(`/${l}/${t[a]}`),g=await s.put(`commoditys/${e.commodity}`);o=o+e.goodsNum*g.price}return o},removeCart:(t,o)=>{let a=t.length;a===0?i.fail("\u60A8\u8FD8\u6CA1\u6709\u9009\u62E9\u5546\u54C1~"):h.confirm({title:`\u5DF2\u9009\u62E9${a}\u4E2A\u5546\u54C1`,message:"\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",cancelButtonText:"\u6211\u518D\u60F3\u60F3"}).then(async()=>{for(let e in t)console.log(t[e]),await s.delete(`${l}/${t[e]}`);u.value.where={user:o},n(),i.success("\u5DF2\u5220\u9664~")}).catch(()=>{})}}};export{E as C};
