import{q as _,V as i,a as F,X as h}from"./reactivity.esm-bundler.f180a2dc.js";import{h as g}from"./http.2cf225b3.js";import{_ as k}from"./iconPark.1cfb687a.js";import{a as G}from"./index.esm.774e7b25.js";import{h as $}from"./http.3d895303.js";import{d as L,o as T,r as y,b as a,c,e,G as f,f as l,h as C,F as H,g as M,w as p,H as A}from"./user.0f0244cd.js";import{T as b}from"./function-call.b3f16382.js";import{D as P}from"./function-call.481ffa2f.js";import"./vendor.1e3ef9c3.js";import"./api.e2fff66e.js";import"./admin-store.fe4adc91.js";import"./crud-api.b919ecb7.js";import"./index.016760bd.js";import"./use-route.2456c025.js";const R={class:"w-90vw"},U={class:"flex justify-center items-center pt-5"},X={key:0},J={key:1},K=L({props:{type:String,addressObject:Object},emits:["end"],setup(D,{emit:v}){const t=D;let u=_({});const j=async n=>{console.log(n);const m=_({name:n.name,province:n.province,city:n.city,county:n.county,address:n.addressDetail,tel:n.tel,postalCode:n.areaCode,isDefault:n.isDefault});t.type=="add"?(console.log(m.value),await $.post("user-info",m.value),b.success("\u65B0\u589E\u6210\u529F~"),v("end",!1)):t.type=="edit"&&t.addressObject&&(await $.put(`user-info/${t.addressObject._id}`,m.value),b.success("\u4FEE\u6539\u6210\u529F~"),v("end",!1))};return T(()=>{t.type==="edit"&&t.addressObject&&(console.log(t.addressObject),u.value={name:t.addressObject.name,province:t.addressObject.province,city:t.addressObject.city,county:t.addressObject.county,addressDetail:t.addressObject.address,tel:t.addressObject.tel,postalCode:t.addressObject.postalCode,areaCode:t.addressObject.postalCode,isDefault:t.addressObject.isDefault})}),(n,m)=>{const o=y("van-address-edit");return a(),c("div",R,[e("div",U,[t.type=="add"?(a(),c("div",X,"\u65B0\u589E\u5730\u5740")):f("",!0),t.type=="edit"?(a(),c("div",J,"\u4FEE\u6539\u5730\u5740")):f("",!0)]),e("div",null,[l(o,{"address-info":i(u),"area-list":i(G),"show-postal":"","show-set-default":"","show-search-result":"","area-columns-placeholder":["\u8BF7\u9009\u62E9","\u8BF7\u9009\u62E9","\u8BF7\u9009\u62E9"],onSave:j},null,8,["address-info","area-list"])])])}}}),Q={class:"bg-gray-100 p-0 w-100vw h-100vh"},Y={class:"flex justify-between items-center pt-2"},Z={class:"mr-5 ml-2 flex justify-between items-center"},ee=e("div",{class:"pl-3"},"\u6211\u7684\u6536\u8D27\u5730\u5740",-1),te={class:"w-16 h-7"},se={key:1},oe={class:"rounded flex justify-center pb-20"},ne={class:"w-full"},ae={class:"py-1"},ie={class:"flex justify-start items-center"},ue={class:"custom-title"},de={class:"text-lg"},le={key:0},ce=A("\u9ED8\u8BA4"),re=["onClick"],pe={class:"flex justify-between items-center"},_e={class:"flex items-center"},fe=["onClick"],ve=e("div",{class:"text-sm"},"\u9ED8\u8BA4\u5730\u5740",-1),me=["onClick"],he=e("div",{class:"text-sm"},"\u5220\u9664",-1),ye=[he],be={class:"flex justify-between items-center pl-3 p-3 w-full fixed bottom-0 bg-white"},ke=A(" \u6DFB\u52A0\u5730\u5740 "),je={key:0,class:"h-80vh"},Ve=L({setup(D){let v=_([]);const t=async()=>{const d=await g.post("user-info/find");v.value=d,v.value.length===0&&b.fail("\u65E0\u6570\u636E~")};let u=_(!0);const j=()=>{u.value=!u.value};_({isDefault:!0});const n=async d=>{b.loading("~"),setTimeout(async()=>{await g.put(`user-info/${d}`,{isDefault:!0}),t()},1e3)},m=d=>{P.confirm({title:"\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u5730\u5740\u5417\uFF1F",cancelButtonText:"\u6211\u518D\u60F3\u60F3"}).then(async()=>{setTimeout(async()=>{await g.delete(`user-info/${d}`),t(),b.success("\u5DF2\u5220\u9664~")},1e3)}).catch(()=>{})};let o=_(!1);const z=()=>{o.value=!o.value,w.value="add"};let E=_({}),w=_();const V=d=>{o.value=!o.value,w.value="edit",E.value=d},I=()=>{O&&t()};let O=localStorage.getItem("token");return T(()=>{O&&t()}),(d,r)=>{const N=y("van-tag"),x=y("van-cell"),S=y("van-cell-group"),W=y("van-button"),q=y("van-popup");return a(),c("div",null,[e("div",Q,[e("div",Y,[e("div",Z,[e("div",null,[e("button",{onClick:r[0]||(r[0]=s=>d.$router.go(-1))},[l(k,{type:"back",theme:"outline",size:"24",spin:!1,fill:"#000000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})])])]),ee,e("div",te,[e("button",{onClick:j},[i(u)?(a(),C(k,{key:0,type:"edit-two",theme:"outline",size:"24",spin:!1,fill:"#000000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})):f("",!0),i(u)?f("",!0):(a(),c("span",se,"\u5B8C\u6210"))])])]),e("div",oe,[e("div",ne,[(a(!0),c(H,null,M(i(v),s=>(a(),c("div",ae,[l(S,{inset:""},{default:p(()=>[l(x,null,{title:p(()=>[e("div",ie,[e("div",ue,[e("span",de,h(s.name),1),e("span",null,h(s.tel),1)]),s.isDefault?(a(),c("div",le,[l(N,{round:"",type:"danger"},{default:p(()=>[ce]),_:1})])):f("",!0)])]),label:p(()=>[e("div",null,h(s.province)+"/ "+h(s.city)+"/ "+h(s.county)+"/ "+h(s.address),1)]),"right-icon":p(()=>[e("button",{onClick:B=>V(s)},[i(u)?(a(),C(k,{key:0,type:"edit",theme:"outline",size:"20  ",spin:!1,fill:"#000000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})):f("",!0)],8,re)]),_:2},1024),i(u)?f("",!0):(a(),C(x,{key:0},{default:p(()=>[e("div",pe,[e("div",_e,[e("div",null,[e("button",{onClick:B=>n(s._id)},[l(k,{type:"round",theme:"outline",size:"18",spin:!1,fill:"#000000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})],8,fe)]),ve]),e("div",null,[e("button",{onClick:B=>m(s._id)},ye,8,me)])])]),_:2},1024))]),_:2},1024)]))),256))])]),e("div",be,[l(W,{type:"primary",size:"large",icon:"plus",round:"",onClick:z},{default:p(()=>[ke]),_:1})])]),e("div",null,[l(q,{round:"",closeable:!0,show:i(o),"onUpdate:show":r[2]||(r[2]=s=>F(o)?o.value=s:o=s),position:"bottom",onClose:r[3]||(r[3]=s=>I())},{default:p(()=>[i(o)?(a(),c("div",je,[l(K,{type:i(w),addressObject:i(E),onEnd:r[1]||(r[1]=s=>{F(o)?o.value=s:o=s})},null,8,["type","addressObject"])])):f("",!0)]),_:1},8,["show"])])])}}});export{Ve as default};
