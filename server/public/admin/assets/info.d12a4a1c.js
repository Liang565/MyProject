import{h as L}from"./http.3d895303.js";import{T as k,w as O}from"./function-call.b3f16382.js";import{q as _,V as n,X as d,a as C}from"./reactivity.esm-bundler.f180a2dc.js";import{h as F}from"./http.2cf225b3.js";import{_ as x}from"./iconPark.1cfb687a.js";import{a as H}from"./index.esm.774e7b25.js";import{d as I,o as A,r as b,b as i,c as p,e,G as m,f as u,h as B,F as P,g as R,w as v,H as S,v as X}from"./user.0f0244cd.js";import{D as J}from"./function-call.481ffa2f.js";const K={class:"w-90vw"},Q={class:"flex justify-center items-center pt-5"},Y={key:0},Z={key:1},ee=I({props:{type:String,addressObject:Object},emits:["end"],setup(E,{emit:j}){const t=E;let l=_({});const h=async s=>{console.log(s);const y=_({name:s.name,province:s.province,city:s.city,county:s.county,address:s.addressDetail,tel:s.tel,postalCode:s.areaCode,isDefault:s.isDefault});t.type=="add"?(console.log(y.value),await L.post("user-info",y.value),k.success("\u65B0\u589E\u6210\u529F~"),j("end",!1)):t.type=="edit"&&t.addressObject&&(await L.put(`user-info/${t.addressObject._id}`,y.value),k.success("\u4FEE\u6539\u6210\u529F~"),j("end",!1))};return A(()=>{t.type==="edit"&&t.addressObject&&(console.log(t.addressObject),l.value={name:t.addressObject.name,province:t.addressObject.province,city:t.addressObject.city,county:t.addressObject.county,addressDetail:t.addressObject.address,tel:t.addressObject.tel,postalCode:t.addressObject.postalCode,areaCode:t.addressObject.postalCode,isDefault:t.addressObject.isDefault})}),(s,y)=>{const f=b("van-address-edit");return i(),p("div",K,[e("div",Q,[t.type=="add"?(i(),p("div",Y,"\u65B0\u589E\u5730\u5740")):m("",!0),t.type=="edit"?(i(),p("div",Z,"\u4FEE\u6539\u5730\u5740")):m("",!0)]),e("div",null,[u(f,{"address-info":n(l),"area-list":n(H),"show-postal":"","show-set-default":"","show-search-result":"","area-columns-placeholder":["\u8BF7\u9009\u62E9","\u8BF7\u9009\u62E9","\u8BF7\u9009\u62E9"],onSave:h},null,8,["address-info","area-list"])])])}}}),te={class:"bg-gray-100 p-0 w-100vw h-100vh"},se={class:"flex justify-between items-center pt-2"},oe=e("div",{class:"mr-5 ml-2 flex justify-between items-center"},[e("div")],-1),ne=e("div",{class:"pl-3"},"\u6211\u7684\u6536\u8D27\u5730\u5740",-1),ae={class:"w-16 h-7"},ie={key:1},le={class:"rounded flex justify-center pb-20"},ue={class:"w-full"},de=["onClick"],ce={class:"flex justify-start items-center"},re={class:"custom-title"},_e={class:"text-lg"},pe={key:0},fe=S("\u9ED8\u8BA4"),ve=["onClick"],he={class:"flex justify-between items-center"},me={class:"flex items-center"},ye=["onClick"],we=e("div",{class:"text-sm"},"\u9ED8\u8BA4\u5730\u5740",-1),be=["onClick"],ke=e("div",{class:"text-sm"},"\u5220\u9664",-1),je=[ke],ge={class:"flex justify-between items-center pl-3 p-3 w-full fixed bottom-0 bg-white"},xe=S(" \u6DFB\u52A0\u5730\u5740 "),Ce={key:0,class:"h-80vh"},Ee=I({emits:["selectMyInfo"],setup(E,{emit:j}){const t=r=>{k.success("\u9009\u62E9\u6210\u529F~"),j("selectMyInfo",r)};let l=_([]);const h=async()=>{const r=await F.post("user-info/find");l.value=r,l.value.length===0&&k.fail("\u65E0\u6570\u636E~")};let s=_(!0);const y=()=>{s.value=!s.value};_({isDefault:!0});const f=async r=>{k.loading("~"),setTimeout(async()=>{await F.put(`user-info/${r}`,{isDefault:!0}),h()},1e3)},c=r=>{J.confirm({title:"\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u5730\u5740\u5417\uFF1F",cancelButtonText:"\u6211\u518D\u60F3\u60F3"}).then(async()=>{setTimeout(async()=>{await F.delete(`user-info/${r}`),h(),k.success("\u5DF2\u5220\u9664~")},1e3)}).catch(()=>{})};let a=_(!1);const w=()=>{a.value=!a.value,D.value="add"};let T=_({}),D=_();const M=r=>{a.value=!a.value,D.value="edit",T.value=r},W=()=>{V&&h()};let V=localStorage.getItem("token");return A(()=>{V&&h()}),(r,g)=>{const N=b("van-tag"),z=b("van-cell"),U=b("van-cell-group"),q=b("van-button"),G=b("van-popup");return i(),p("div",null,[e("div",te,[e("div",se,[oe,ne,e("div",ae,[e("button",{onClick:y},[n(s)?(i(),B(x,{key:0,type:"edit-two",theme:"outline",size:"24",spin:!1,fill:"#000000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})):m("",!0),n(s)?m("",!0):(i(),p("span",ie,"\u5B8C\u6210"))])])]),e("div",le,[e("div",ue,[(i(!0),p(P,null,R(n(l),o=>(i(),p("div",{class:"py-1",onClick:$=>t(o)},[u(U,{inset:""},{default:v(()=>[u(z,null,{title:v(()=>[e("div",ce,[e("div",re,[e("span",_e,d(o.name),1),e("span",null,d(o.tel),1)]),o.isDefault?(i(),p("div",pe,[u(N,{round:"",type:"danger"},{default:v(()=>[fe]),_:1})])):m("",!0)])]),label:v(()=>[e("div",null,d(o.province)+"/ "+d(o.city)+"/ "+d(o.county)+"/ "+d(o.address),1)]),"right-icon":v(()=>[e("button",{onClick:O($=>M(o),["stop"])},[n(s)?(i(),B(x,{key:0,type:"edit",theme:"outline",size:"20  ",spin:!1,fill:"#000000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})):m("",!0)],8,ve)]),_:2},1024),n(s)?m("",!0):(i(),B(z,{key:0},{default:v(()=>[e("div",he,[e("div",me,[e("div",null,[e("button",{onClick:O($=>f(o._id),["stop"])},[u(x,{type:"round",theme:"outline",size:"18",spin:!1,fill:"#000000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})],8,ye)]),we]),e("div",null,[e("button",{onClick:O($=>c(o._id),["stop"])},je,8,be)])])]),_:2},1024))]),_:2},1024)],8,de))),256))])]),e("div",ge,[u(q,{type:"primary",size:"large",icon:"plus",round:"",onClick:w},{default:v(()=>[xe]),_:1})])]),e("div",null,[u(G,{round:"",closeable:!0,show:n(a),"onUpdate:show":g[1]||(g[1]=o=>C(a)?a.value=o:a=o),position:"bottom",onClose:g[2]||(g[2]=o=>W())},{default:v(()=>[n(a)?(i(),p("div",Ce,[u(ee,{type:n(D),addressObject:n(T),onEnd:g[0]||(g[0]=o=>{C(a)?a.value=o:a=o})},null,8,["type","addressObject"])])):m("",!0)]),_:1},8,["show"])])])}}}),De={class:"flex justify-between w-90vw bg-gray-50 p-3 rounded-lg"},$e={class:"flex items-center"},Oe={class:"text-base"},Fe={class:"pr-2"},Be={class:"flex items-center"},We=I({emits:["selectInfo"],setup(E,{emit:j}){let t=_({address:"",city:"",county:"",id:"",isDefault:!0,name:"",postalCode:"",province:"",tel:"",user:"",_id:""}),l=_(!1);const h=()=>{j("selectInfo",t.value)},s=()=>{l.value=!0};return(async()=>{const f=await L.post("user-info/find");for(let c in f)if(f[c].isDefault){t.value=f[c];return}k.fail("\u65E0\u6570\u636E~")})(),X(t,(f,c)=>{h()}),(f,c)=>{const a=b("van-action-sheet");return i(),p("div",null,[e("div",{class:"flex justify-center py-3",onClick:s},[e("div",De,[e("div",$e,[u(x,{type:"local-two",theme:"filled",size:"35",spin:!1,fill:"#4a90e2",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})]),e("div",null,[e("div",Oe,d(n(t).province)+"/ "+d(n(t).city)+"/ "+d(n(t).county)+"/ "+d(n(t).address),1),e("div",null,[e("span",Fe,d(n(t).name),1),e("span",null,d(n(t).tel),1)])]),e("div",Be,[u(x,{type:"right",theme:"outline",size:"24",spin:!1,fill:"#000000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})])])]),e("div",null,[u(a,{show:n(l),"onUpdate:show":c[1]||(c[1]=w=>C(l)?l.value=w:l=w),title:"\u9009\u62E9\u5730\u5740"},{default:v(()=>[u(Ee,{onSelectMyInfo:c[0]||(c[0]=w=>{C(t)?t.value=w:t=w})})]),_:1},8,["show"])])])}}});export{We as _};
