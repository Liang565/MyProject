import{f as W,g as _,h as X,r as p,o as c,j as f,p as v,k as e,w as t,l as u,m as R,t as s,y as d,L as O,Q as F}from"./vendor.1e3ef9c3.js";import{h as S}from"./http.3d895303.js";import{C as Y}from"./crud-api.b919ecb7.js";import"./user-store.80d0fbbe.js";import"./admin-store.fe4adc91.js";/* empty css                                                  */import"./reactivity.esm-bundler.f180a2dc.js";const Z={class:"mb-2 flex justify-start"},ee=d("\u641C\u7D22"),te={class:"mt-5 h-70vh overflow-y-auto"},ue={class:"w-20 overflow-hidden text-ellipsis whitespace-nowrap"},ae={key:0,class:"w-20 overflow-hidden text-ellipsis whitespace-nowrap"},le={key:1},oe={key:0},ne={key:1},se={key:0,class:"w-20 overflow-hidden text-ellipsis whitespace-nowrap"},ie={key:1},de=d("\u4FEE\u6539"),re=d("\u5220\u9664"),me={key:0},_e={key:1},be=W({setup(pe){const{remove:N,viss:D,addOk:ce,fetch:B,data:M,query:fe,where:k,search:h,pagination:U,pageChange:L}=Y("orders");_(!0),_(!1),_("");const w=localStorage.getItem("role");let g=_([]);const T=async()=>{const i=await S.post(`/commoditys/Goods/${localStorage.userid}`);!i||i.length==0?w==="admin"?R.info("\u5F53\u524D\u4E3A\u7BA1\u7406\u5458\u7528\u6237"):R.info("\u8BE5\u7528\u6237\u4E0B\u65E0\u5E97\u94FA"):(g.value=i.map(l=>({label:l.title,value:l.id})),g.value[0].value&&(k.value.shop=g.value[0].value,E.value.shop=k.value.shop,h()))},V=()=>{E.value.shop=k.value.shop,h()};_("addShop");let E=_({}),o=_({});const j=()=>{E.value={},o.value={},r.value={express:"",settingRemarks:"",state:""}};let A=_([{label:"\u672A\u652F\u4ED8",value:"\u672A\u652F\u4ED8"},{label:"\u5F85\u53D1\u8D27",value:"\u5F85\u53D1\u8D27"},{label:"\u5F85\u6536\u8D27",value:"\u5F85\u6536\u8D27"},{label:"\u5F85\u8BC4\u4EF7",value:"\u5F85\u8BC4\u4EF7"},{label:"\u5DF2\u6536\u8D27",value:"\u5DF2\u6536\u8D27"},{label:"\u9000\u8D27\u7533\u8BF7",value:"\u9000\u8D27\u7533\u8BF7"},{label:"\u5DF2\u9000\u8D27",value:"\u5DF2\u9000\u8D27"},{label:"\u53D6\u6D88\u8BA2\u5355",value:"\u53D6\u6D88\u8BA2\u5355"}]);const I=(i,l)=>l.label.toLowerCase().indexOf(i.toLowerCase())>=0,G=()=>{j()};_("");let r=_({express:"",settingRemarks:"",state:""});const q=i=>{o.value=i,D.value.edit=!0,r.value.express=i.express,r.value.settingRemarks=i.settingRemarks,r.value.state=i.state},K=async i=>{await S.put(`orders/${i._id}`,r.value),D.value.edit=!1,B()},$=(i,l)=>{O.info({title:`${l}`,content:F("div",{},`${i}`),onOk(){}})},Q=(i,l)=>{O.info({title:`${l}`,content:F("text",{},[F("p",`\u5546\u54C1id:  ${i._id}`),F("p",`\u5546\u54C1\u540D\u79F0:${i.commodityName}`),F("p",`\u5546\u54C1\u4EF7\u683C:${i.price}`)]),onOk(){}})};return X(()=>{T(),w=="admin"&&B()}),(i,l)=>{const x=p("a-select"),n=p("a-form-item"),y=p("a-form"),C=p("a-button"),m=p("a-table-column"),z=p("a-table"),H=p("a-input"),J=p("a-textarea"),P=p("a-modal");return c(),f("div",null,[v("div",Z,[v("div",null,[e(y,{layout:"inline"},{default:t(()=>[e(n,{label:"\u5207\u6362\u5E97\u94FA",class:"w-44"},{default:t(()=>[e(x,{options:u(g),value:u(k).shop,"onUpdate:value":l[0]||(l[0]=a=>u(k).shop=a),onChange:V},null,8,["options","value"])]),_:1})]),_:1})]),v("div",null,[e(y,{layout:"inline"},{default:t(()=>[e(n,{label:"\u72B6\u6001",class:"w-44"},{default:t(()=>[e(x,{options:u(A),value:u(k).state,"onUpdate:value":l[1]||(l[1]=a=>u(k).state=a),allowClear:!0,showSearch:!0,"filter-Option":I},null,8,["options","value"])]),_:1}),e(n,null,{default:t(()=>[e(C,{type:"primary",onClick:u(h)},{default:t(()=>[ee]),_:1},8,["onClick"])]),_:1})]),_:1})])]),v("div",te,[e(z,{dataSource:u(M),rowKey:"_id",pagination:u(U),onChange:u(L)},{default:t(()=>[e(m,{title:"\u8BA2\u5355\u53F7",dataIndex:"_id",key:"_id",align:"center"}),e(m,{title:"\u5546\u54C1",dataIndex:"commodity",key:"commodity",align:"center"},{default:t(({record:a})=>[e(C,{type:"link",onClick:b=>Q(a.commodity,"\u5546\u54C1")},{default:t(()=>[v("div",ue,s(a.commodity.commodityName),1)]),_:2},1032,["onClick"])]),_:1}),e(m,{align:"center",title:"\u6570\u91CF",dataIndex:"goodsNum",key:"goodsNum"}),e(m,{align:"center",title:"\u8BA2\u5355\u5907\u6CE8",dataIndex:"remarks",key:"remarks"},{default:t(({record:a})=>[e(C,{type:"link",onClick:b=>$(a.remarks,"\u8BA2\u5355\u5907\u6CE8")},{default:t(()=>[a.remarks?(c(),f("div",ae,s(a.remarks),1)):(c(),f("div",le,"\u65E0\u5907\u6CE8"))]),_:2},1032,["onClick"])]),_:1}),e(m,{align:"center",title:"\u91D1\u989D",dataIndex:"money",key:"money"}),e(m,{align:"center",title:"\u8BA2\u5355\u72B6\u6001",dataIndex:"state",key:"state"}),e(m,{align:"center",title:"\u8BA2\u5355\u521B\u5EFA\u65F6\u95F4",dataIndex:"createdAt",key:"createdAt"}),e(m,{align:"center",title:"\u6536\u8D27\u4EBA\u4FE1\u606F",dataIndex:"userInfo",key:"userInfo"},{default:t(({record:a})=>[v("div",null,s(a.userInfo.name),1)]),_:1}),e(m,{align:"center",title:"\u5FEB\u9012",dataIndex:"express",key:"express"},{default:t(({record:a})=>[a.express?(c(),f("div",oe,s(a.express),1)):(c(),f("div",ne,"\u65E0"))]),_:1}),e(m,{align:"center",title:"\u64CD\u4F5C\u5907\u6CE8",dataIndex:"settingRemarks",key:"settingRemarks"},{default:t(({record:a})=>[e(C,{type:"link",onClick:b=>$(a.settingRemarks,"\u64CD\u4F5C\u5907\u6CE8")},{default:t(()=>[a.settingRemarks?(c(),f("div",se,s(a.settingRemarks),1)):(c(),f("div",ie,"\u65E0\u5907\u6CE8"))]),_:2},1032,["onClick"])]),_:1}),e(m,{title:"\u64CD\u4F5C",dataIndex:"operation",key:"operation",align:"center"},{default:t(({record:a})=>[v("div",null,[e(C,{type:"link",onClick:b=>q(a)},{default:t(()=>[de]),_:2},1032,["onClick"]),e(C,{type:"link",onClick:b=>u(N)(a,a.commodityName)},{default:t(()=>[re]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["dataSource","pagination","onChange"])]),v("div",null,[e(P,{visible:u(D).edit,"onUpdate:visible":l[5]||(l[5]=a=>u(D).edit=a),title:"\u4FEE\u6539",onOk:l[6]||(l[6]=a=>K(u(o))),afterClose:G,centered:!0,destroyOnClose:!0},{default:t(()=>[e(y,{model:u(o)},{default:t(()=>[e(n,{label:"\u8BA2\u5355\u53F7"},{default:t(()=>[d(s(u(o)._id),1)]),_:1}),e(n,{label:"\u5546\u54C1"},{default:t(()=>[e(y,null,{default:t(()=>[e(n,{label:"\u5546\u54C1\u540D\u79F0"},{default:t(()=>[d(s(u(o).commodity.commodityName),1)]),_:1}),e(n,{label:"\u5546\u54C1id"},{default:t(()=>[d(s(u(o).commodity._id),1)]),_:1}),e(n,{label:"\u5546\u54C1\u4EF7\u683C"},{default:t(()=>[d(s(u(o).commodity.price),1)]),_:1})]),_:1})]),_:1}),e(n,{label:"\u6570\u91CF"},{default:t(()=>[d(s(u(o).goodsNum),1)]),_:1}),e(n,{label:"\u8BA2\u5355\u5907\u6CE8"},{default:t(()=>[u(o).remarks&&u(o).remark!=""?(c(),f("div",me,s(u(o).remarks),1)):(c(),f("div",_e,"\u65E0"))]),_:1}),e(n,{label:"\u8BA2\u5355\u91D1\u989D"},{default:t(()=>[d(s(u(o).money),1)]),_:1}),e(n,{label:"\u8BA2\u5355\u72B6\u6001"},{default:t(()=>[e(x,{options:u(A),value:u(r).state,"onUpdate:value":l[2]||(l[2]=a=>u(r).state=a),allowClear:!0,showSearch:!0,"filter-Option":I},null,8,["options","value"])]),_:1}),e(n,{label:"\u6536\u8D27\u4EBA\u4FE1\u606F"},{default:t(()=>[e(y,null,{default:t(()=>[e(n,{label:"\u59D3\u540D"},{default:t(()=>[d(s(u(o).userInfo.name),1)]),_:1}),e(n,{label:"\u59D3\u540D"},{default:t(()=>[d(s(u(o).userInfo.name),1)]),_:1}),e(n,{label:"\u5730\u5740"},{default:t(()=>[d(s(u(o).userInfo.province)+"\\ "+s(u(o).userInfo.city)+"\\ "+s(u(o).userInfo.county)+"\\ "+s(u(o).userInfo.address)+"\\ ",1)]),_:1}),e(n,{label:"\u8054\u7CFB\u7535\u8BDD"},{default:t(()=>[d(s(u(o).userInfo.tel),1)]),_:1}),e(n,{label:"\u90AE\u653F\u7F16\u53F7"},{default:t(()=>[d(s(u(o).userInfo.postalCode),1)]),_:1})]),_:1})]),_:1}),e(n,{label:"\u5FEB\u9012\u53F7"},{default:t(()=>[e(H,{value:u(r).express,"onUpdate:value":l[3]||(l[3]=a=>u(r).express=a)},null,8,["value"])]),_:1}),e(n,{label:"\u64CD\u4F5C\u5907\u6CE8"},{default:t(()=>[e(J,{row:4,value:u(r).settingRemarks,"onUpdate:value":l[4]||(l[4]=a=>u(r).settingRemarks=a),maxlength:"200",showCount:!0},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])])])}}});export{be as default};
