import{d as h,r,o as v,c as S,w as o,k as b,u as e,p as n,h as c,x as J,l,n as P,F as V,j as Q,v as W,y as $}from"./vendor.ce4e530f.js";import{a as X}from"./api.9c38940f.js";import"./http.fc6e7509.js";import{C as Y}from"./crud-api.7293b100.js";import{R as Z}from"./register-and-login.1c71b176.js";import"./admin-store.26ef1a35.js";const ee=["src"],le={key:1},te=n("div",{class:"ant-upload-text"},"\u70B9\u51FB\u4E0A\u4F20",-1),N=h({props:{imageUrl:String},emits:["on-success"],setup(k,{emit:f}){const{httpURL:d}=Z(),y=(p,U,x)=>{var i;f("on-success",(i=p.file.response)==null?void 0:i.url)},F=()=>!0;return(p,U)=>{const x=r("loading-outlined"),i=r("plus-outlined"),g=r("a-upload");return v(),S(g,{name:"file","list-type":"picture-card","show-upload-list":!1,action:e(d)+"/upload",onChange:y,"before-upload":F},{default:o(()=>[k.imageUrl?(v(),b("img",{key:0,src:k.imageUrl,alt:"avatar"},null,8,ee)):(v(),b("div",le,[p.loading?(v(),S(x,{key:0})):(v(),S(i,{key:1})),te]))]),_:1},8,["action"])}}});const ae={class:"aaaaa"},ue=["src"],oe=n("span",null,"\u6D4F\u89C8",-1),ne=[oe],se=n("div",null,null,-1),ie={key:0,class:"tuku"},de={class:"main"},re=["src"],pe=h({props:{URL:String},setup(k){const f=k;let d=c(!0);const y=()=>{d.value=!1},F=()=>{d.value=!0};let p=c(!1);const U=()=>{console.log("looooook"),p.value=!0};return c(!1),(x,i)=>{const g=r("a-modal");return v(),b(V,null,[n("div",ae,[n("div",{onMouseenter:y,onMouseleave:F,class:"fa"},[n("img",{src:f.URL,class:"imgimg"},null,8,ue),e(d)?J("",!0):(v(),b("button",{key:0,class:"aaa",onClick:U},ne))],32)]),l(g,{visible:e(p),"onUpdate:visible":i[0]||(i[0]=E=>P(p)?p.value=E:p=E),width:"100%",style:{top:"0px"}},{footer:o(()=>[se]),default:o(()=>[(v(),b("div",ie,[n("div",de,[n("img",{src:f.URL,alt:"",class:"imgMain"},null,8,re)])]))]),_:1},8,["visible"])],64)}}}),me=n("div",{class:"mb-2 text-2xl"},"\u5546\u94FA\u7BA1\u7406",-1),ve={class:"mb-2 flex justify-start"},_e=$(" \u65B0\u589E\u5546\u94FA "),ce={class:"w-full ml-8"},fe=$("\u641C\u7D22"),ge={class:"my-5"},Ce=$("\u4FEE\u6539"),be=$("\u5220\u9664"),Ee=h({setup(k){const{remove:f,viss:d,editOk:y,addOk:F,fetch:p,data:U,query:x,where:i,search:g,pagination:E,pageChange:j}=Y("shops");let T=c("addShop");localStorage.getItem("role")==="admin"?i.value={title:"",user:""}:i.value={title:"",user:localStorage.getItem("userid")};let u=c({title:"",user:localStorage.getItem("userid"),description:"",images:"",address:"",phone:""});const q=()=>{u.value={title:"",user:u.value.user,description:"",images:"",address:"",phone:""}},K=()=>{d.value.add=!0};let O=c(!1),A=c([]);const z=async()=>{if(localStorage.getItem("role")==="admin"){const C=await X.user.find({limit:999});A.value=C.data.map(t=>({label:t.username,value:t._id})),O.value=!0}else A.value=[{label:localStorage.getItem("username"),value:localStorage.getItem("userid")}]},R=()=>{q(),console.log("cancel")};let L=c("");const G=C=>{for(let t in u.value)u.value[t]=C[t];u.value.user=C.user._id,L.value=C._id,d.value.edit=!0};return Q(()=>{g(),z()}),(C,t)=>{const B=r("a-button"),m=r("a-input"),s=r("a-form-item"),w=r("a-select"),I=r("a-form"),_=r("a-table-column"),H=r("a-table"),M=r("a-modal");return v(),b(V,null,[n("div",null,[me,n("div",ve,[n("div",null,[l(B,{onClick:K,type:"primary"},{default:o(()=>[_e]),_:1})]),n("div",ce,[l(I,{layout:"inline"},{default:o(()=>[l(s,{label:"\u5E97\u94FA\u540D\uFF1A",class:"w-52"},{default:o(()=>[l(m,{value:e(i).title,"onUpdate:value":t[0]||(t[0]=a=>e(i).title=a)},null,8,["value"])]),_:1}),l(s,{label:"\u6240\u5C5E\u7528\u6237\u540D",class:"w-44"},{default:o(()=>[l(w,{options:e(A),value:e(i).user,"onUpdate:value":t[1]||(t[1]=a=>e(i).user=a),allowClear:e(O)},null,8,["options","value","allowClear"])]),_:1}),l(s,null,{default:o(()=>[l(B,{type:"primary",onClick:e(g)},{default:o(()=>[fe]),_:1},8,["onClick"])]),_:1})]),_:1})])]),n("div",ge,[l(H,{dataSource:e(U),rowKey:"title",pagination:e(E),onChange:e(j),scroll:{y:400}},{default:o(()=>[l(_,{title:"\u5546\u94FA\u540D",dataIndex:"title",key:"title",class:"w-60",align:"center"}),l(_,{title:"id",dataIndex:"_id",key:"_id",align:"center"}),l(_,{title:"\u6240\u5C5E\u7528\u6237",dataIndex:"user",key:"user",align:"center"},{default:o(({record:a})=>{var D;return[n("span",null,W((D=a.user)==null?void 0:D.username),1)]}),_:1}),l(_,{title:"\u5546\u94FA\u7B80\u4ECB",dataIndex:"description",key:"description",align:"center"}),l(_,{title:"\u5546\u94FA\u5934\u50CF",dataIndex:"images",key:"images",align:"center"},{default:o(({record:a})=>[l(pe,{URL:a.images},null,8,["URL"])]),_:1}),l(_,{title:"\u5546\u94FA\u5730\u5740",dataIndex:"address",key:"address",align:"center"}),l(_,{title:"\u5546\u94FA\u7535\u8BDD",dataIndex:"phone",key:"phone",align:"center"}),l(_,{title:"\u64CD\u4F5C",dataIndex:"operation",key:"operation",align:"center"},{default:o(({record:a})=>[n("div",null,[l(B,{type:"link",onClick:D=>G(a)},{default:o(()=>[Ce]),_:2},1032,["onClick"]),l(B,{type:"link",onClick:D=>e(f)(a,a.title)},{default:o(()=>[be]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["dataSource","pagination","onChange"])])]),n("div",null,[l(M,{visible:e(d).add,"onUpdate:visible":t[8]||(t[8]=a=>e(d).add=a),title:"\u65B0\u589E\u5546\u94FA",onOk:t[9]||(t[9]=a=>e(F)(e(u),e(T))),afterClose:R,centered:!0},{default:o(()=>[l(I,{model:e(u)},{default:o(()=>[l(s,{label:"\u5546\u5E97\u540D"},{default:o(()=>[l(m,{value:e(u).title,"onUpdate:value":t[2]||(t[2]=a=>e(u).title=a)},null,8,["value"])]),_:1}),l(s,{label:"\u6240\u5C5E\u7528\u6237\u540D"},{default:o(()=>[l(w,{options:e(A),value:e(u).user,"onUpdate:value":t[3]||(t[3]=a=>e(u).user=a)},null,8,["options","value"])]),_:1}),l(s,{label:"\u5546\u94FA\u7B80\u4ECB"},{default:o(()=>[l(m,{value:e(u).description,"onUpdate:value":t[4]||(t[4]=a=>e(u).description=a)},null,8,["value"])]),_:1}),l(s,{label:"\u5546\u94FA\u5934\u50CF"},{default:o(()=>[l(N,{imageUrl:e(u).images,onOnSuccess:t[5]||(t[5]=a=>{e(u).images=a})},null,8,["imageUrl"])]),_:1}),l(s,{label:"\u5546\u94FA\u5730\u5740"},{default:o(()=>[l(m,{value:e(u).address,"onUpdate:value":t[6]||(t[6]=a=>e(u).address=a)},null,8,["value"])]),_:1}),l(s,{label:"\u5546\u94FA\u7535\u8BDD"},{default:o(()=>[l(m,{value:e(u).phone,"onUpdate:value":t[7]||(t[7]=a=>e(u).phone=a)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])]),n("div",null,[l(M,{visible:e(d).edit,"onUpdate:visible":t[16]||(t[16]=a=>e(d).edit=a),title:"\u4FEE\u6539\u4FE1\u606F",afterClose:R,onOk:t[17]||(t[17]=a=>e(y)(e(L),e(u))),centered:!0},{default:o(()=>[l(I,{model:e(u)},{default:o(()=>[l(s,{label:"\u5546\u5E97\u540D"},{default:o(()=>[l(m,{value:e(u).title,"onUpdate:value":t[10]||(t[10]=a=>e(u).title=a)},null,8,["value"])]),_:1}),l(s,{label:"\u6240\u5C5E\u7528\u6237\u540D"},{default:o(()=>[l(w,{options:e(A),value:e(u).user,"onUpdate:value":t[11]||(t[11]=a=>e(u).user=a)},null,8,["options","value"])]),_:1}),l(s,{label:"\u5546\u94FA\u7B80\u4ECB"},{default:o(()=>[l(m,{value:e(u).description,"onUpdate:value":t[12]||(t[12]=a=>e(u).description=a)},null,8,["value"])]),_:1}),l(s,{label:"\u5546\u94FA\u5934\u50CF"},{default:o(()=>[l(N,{imageUrl:e(u).images,onOnSuccess:t[13]||(t[13]=a=>{e(u).images=a})},null,8,["imageUrl"])]),_:1}),l(s,{label:"\u5546\u94FA\u5730\u5740"},{default:o(()=>[l(m,{value:e(u).address,"onUpdate:value":t[14]||(t[14]=a=>e(u).address=a)},null,8,["value"])]),_:1}),l(s,{label:"\u5546\u94FA\u7535\u8BDD"},{default:o(()=>[l(m,{value:e(u).phone,"onUpdate:value":t[15]||(t[15]=a=>e(u).phone=a)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])])],64)}}});export{Ee as default};
