import{u as y}from"./user.0f0244cd.js";import{h as r}from"./http.2cf225b3.js";import{D as h}from"./function-call.481ffa2f.js";import{q as c}from"./reactivity.esm-bundler.f180a2dc.js";import{T as l}from"./function-call.b3f16382.js";const q=i=>{const g=y();let m=c(),f=c(),u=c({limit:0,page:1,where:c()});const n=async()=>{const o=await r.get(`/${i}`,{params:{query:u.value}});if(o.total==0)l.fail("\u65E0\u6570\u636E~"),m.value=[];else{const t=JSON.stringify(u.value);g.push({query:{query1:t}}),m.value=o.data,f.value=o.total}};return{fetch:n,search:async()=>{console.log(u),n()},data:m,query:u,goGoods:o=>{g.push(`/goods/${o._id}`)},total:f,totalSum:async o=>{let t=0,e=[];for(let a in o){const s=await r.put(`/${i}/${o[a]}`),d=await r.put(`commoditys/${s.commodity}`);s.goodsNum>d.commodityNum?l.loading(`\u5546\u54C1\uFF1A${d.commodityName}\u5E93\u5B58\u4E0D\u8DB3~`):(e.push({goodsNum:s.goodsNum,commodity:s.commodity,cartId:o[a]}),t=t+s.goodsNum*d.price)}return{totalSum:t,goodsOrder:e}},removeCart:(o,t)=>{let e=o.length;e===0?l.fail("\u60A8\u8FD8\u6CA1\u6709\u9009\u62E9\u5546\u54C1~"):h.confirm({title:`\u5DF2\u9009\u62E9${e}\u4E2A\u5546\u54C1`,message:"\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",cancelButtonText:"\u6211\u518D\u60F3\u60F3"}).then(async()=>{for(let a in o)console.log(o[a]),await r.delete(`${i}/${o[a]}`);u.value.where={user:t},n(),l.success("\u5DF2\u5220\u9664~")}).catch(()=>{})}}};export{q as C};
