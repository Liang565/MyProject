import{d as h,r,o as v,c as S,w as o,h as b,l as e,j as s,p as c,z as J,i as l,x as P,F as V,g as Q,t as W,n as $}from"./vendor.70f74869.js";import{a as X}from"./api.a15ee8ec.js";import"./http.c8672c53.js";import{C as Y}from"./crud-api.2cd90b34.js";import{R as Z}from"./register-and-login.87c94732.js";import"./admin-store.5d141a94.js";const ee=["src"],le={key:1},te=s("div",{class:"ant-upload-text"},"\u70B9\u51FB\u4E0A\u4F20",-1),N=h({props:{imageUrl:String},emits:["on-success"],setup(k,{emit:g}){const{httpURL:d}=Z(),y=(p,U,x)=>{var i;g("on-success",(i=p.file.response)==null?void 0:i.url)},F=()=>!0;return(p,U)=>{const x=r("loading-outlined"),i=r("plus-outlined"),C=r("a-upload");return v(),S(C,{name:"file","list-type":"picture-card","show-upload-list":!1,action:e(d)+"/upload",onChange:y,"before-upload":F},{default:o(()=>[k.imageUrl?(v(),b("img",{key:0,src:k.imageUrl,alt:"avatar"},null,8,ee)):(v(),b("div",le,[p.loading?(v(),S(x,{key:0})):(v(),S(i,{key:1})),te]))]),_:1},8,["action"])}}});const ue={class:"aaaaa"},ae=["src"],oe=s("span",null,"\u6D4F\u89C8",-1),se=[oe],ne=s("div",null,null,-1),ie={key:0,class:"tuku"},de={class:"main"},re=["src"],pe=h({props:{URL:String},setup(k){const g=k;let d=c(!0);const y=()=>{d.value=!1},F=()=>{d.value=!0};let p=c(!1);const U=()=>{console.log("looooook"),p.value=!0};return c(!1),(x,i)=>{const C=r("a-modal");return v(),b(V,null,[s("div",ue,[s("div",{onMouseenter:y,onMouseleave:F,class:"fa"},[s("img",{src:g.URL,class:"imgimg"},null,8,ae),e(d)?J("",!0):(v(),b("button",{key:0,class:"aaa",onClick:U},se))],32)]),l(C,{visible:e(p),"onUpdate:visible":i[0]||(i[0]=E=>P(p)?p.value=E:p=E),width:"100%",style:{top:"0px"}},{footer:o(()=>[ne]),default:o(()=>[(v(),b("div",ie,[s("div",de,[s("img",{src:g.URL,alt:"",class:"imgMain"},null,8,re)])]))]),_:1},8,["visible"])],64)}}}),me=s("div",{class:"mb-2 text-2xl"},"\u5546\u94FA\u7BA1\u7406",-1),ve={class:"mb-2 flex justify-start"},_e=$(" \u65B0\u589E\u5546\u94FA "),ce={class:"w-full ml-8"},fe=$("\u641C\u7D22"),ge={class:"my-5"},Ce=$("\u4FEE\u6539"),be=$("\u5220\u9664"),Ee=h({setup(k){const{remove:g,viss:d,editOk:y,addOk:F,fetch:p,data:U,query:x,where:i,search:C,pagination:E,pageChange:j}=Y("shops");let T=c("addShop");localStorage.getItem("role")==="admin"?i.value={title:"",user:""}:i.value={title:"",user:localStorage.getItem("userid")};let a=c({title:"",user:localStorage.getItem("userid"),description:"",images:"",address:"",phone:""});const q=()=>{a.value={title:"",user:a.value.user,description:"",images:"",address:"",phone:""}},z=()=>{d.value.add=!0};let O=c(!1),A=c([]);const K=async()=>{if(localStorage.getItem("role")==="admin"){const f=await X.user.find({limit:999});A.value=f.data.map(t=>({label:t.username,value:t._id})),O.value=!0}else A.value=[{label:localStorage.getItem("username"),value:localStorage.getItem("userid")}]},R=()=>{q(),console.log("cancel")};let L=c("");const G=f=>{console.log(f);for(let t in a.value)a.value[t]=f[t];a.value.user=f.user._id,L.value=f._id,d.value.edit=!0};return Q(()=>{C(),K()}),(f,t)=>{const B=r("a-button"),m=r("a-input"),n=r("a-form-item"),w=r("a-select"),I=r("a-form"),_=r("a-table-column"),H=r("a-table"),M=r("a-modal");return v(),b(V,null,[s("div",null,[me,s("div",ve,[s("div",null,[l(B,{onClick:z,type:"primary"},{default:o(()=>[_e]),_:1})]),s("div",ce,[l(I,{layout:"inline"},{default:o(()=>[l(n,{label:"\u5E97\u94FA\u540D\uFF1A",class:"w-52"},{default:o(()=>[l(m,{value:e(i).title,"onUpdate:value":t[0]||(t[0]=u=>e(i).title=u)},null,8,["value"])]),_:1}),l(n,{label:"\u6240\u5C5E\u7528\u6237\u540D",class:"w-44"},{default:o(()=>[l(w,{options:e(A),value:e(i).user,"onUpdate:value":t[1]||(t[1]=u=>e(i).user=u),allowClear:e(O)},null,8,["options","value","allowClear"])]),_:1}),l(n,null,{default:o(()=>[l(B,{type:"primary",onClick:e(C)},{default:o(()=>[fe]),_:1},8,["onClick"])]),_:1})]),_:1})])]),s("div",ge,[l(H,{dataSource:e(U),rowKey:"title",pagination:e(E),onChange:e(j),scroll:{y:400}},{default:o(()=>[l(_,{title:"\u5546\u94FA\u540D",dataIndex:"title",key:"title",class:"w-60"}),l(_,{title:"id",dataIndex:"_id",key:"_id"}),l(_,{title:"\u6240\u5C5E\u7528\u6237",dataIndex:"user",key:"user"},{default:o(({record:u})=>{var D;return[s("span",null,W((D=u.user)==null?void 0:D.username),1)]}),_:1}),l(_,{title:"\u5546\u94FA\u7B80\u4ECB",dataIndex:"description",key:"description"}),l(_,{title:"\u5546\u94FA\u5934\u50CF",dataIndex:"images",key:"images"},{default:o(({record:u})=>[l(pe,{URL:u.images},null,8,["URL"])]),_:1}),l(_,{title:"\u5546\u94FA\u5730\u5740",dataIndex:"address",key:"address"}),l(_,{title:"\u5546\u94FA\u7535\u8BDD",dataIndex:"phone",key:"phone"}),l(_,{title:"\u64CD\u4F5C",dataIndex:"operation",key:"operation"},{default:o(({record:u})=>[s("div",null,[l(B,{type:"link",onClick:D=>G(u)},{default:o(()=>[Ce]),_:2},1032,["onClick"]),l(B,{type:"link",onClick:D=>e(g)(u,u.title)},{default:o(()=>[be]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["dataSource","pagination","onChange"])])]),s("div",null,[l(M,{visible:e(d).add,"onUpdate:visible":t[8]||(t[8]=u=>e(d).add=u),title:"\u65B0\u589E\u5546\u94FA",onOk:t[9]||(t[9]=u=>e(F)(e(a),e(T))),afterClose:R},{default:o(()=>[l(I,{model:e(a)},{default:o(()=>[l(n,{label:"\u5546\u5E97\u540D"},{default:o(()=>[l(m,{value:e(a).title,"onUpdate:value":t[2]||(t[2]=u=>e(a).title=u)},null,8,["value"])]),_:1}),l(n,{label:"\u6240\u5C5E\u7528\u6237\u540D"},{default:o(()=>[l(w,{options:e(A),value:e(a).user,"onUpdate:value":t[3]||(t[3]=u=>e(a).user=u)},null,8,["options","value"])]),_:1}),l(n,{label:"\u5546\u94FA\u7B80\u4ECB"},{default:o(()=>[l(m,{value:e(a).description,"onUpdate:value":t[4]||(t[4]=u=>e(a).description=u)},null,8,["value"])]),_:1}),l(n,{label:"\u5546\u94FA\u5934\u50CF"},{default:o(()=>[l(N,{imageUrl:e(a).images,onOnSuccess:t[5]||(t[5]=u=>{e(a).images=u})},null,8,["imageUrl"])]),_:1}),l(n,{label:"\u5546\u94FA\u5730\u5740"},{default:o(()=>[l(m,{value:e(a).address,"onUpdate:value":t[6]||(t[6]=u=>e(a).address=u)},null,8,["value"])]),_:1}),l(n,{label:"\u5546\u94FA\u7535\u8BDD"},{default:o(()=>[l(m,{value:e(a).phone,"onUpdate:value":t[7]||(t[7]=u=>e(a).phone=u)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])]),s("div",null,[l(M,{visible:e(d).edit,"onUpdate:visible":t[16]||(t[16]=u=>e(d).edit=u),title:"\u4FEE\u6539\u4FE1\u606F",afterClose:R,onOk:t[17]||(t[17]=u=>e(y)(e(L),e(a)))},{default:o(()=>[l(I,{model:e(a)},{default:o(()=>[l(n,{label:"\u5546\u5E97\u540D"},{default:o(()=>[l(m,{value:e(a).title,"onUpdate:value":t[10]||(t[10]=u=>e(a).title=u)},null,8,["value"])]),_:1}),l(n,{label:"\u6240\u5C5E\u7528\u6237\u540D"},{default:o(()=>[l(w,{options:e(A),value:e(a).user,"onUpdate:value":t[11]||(t[11]=u=>e(a).user=u)},null,8,["options","value"])]),_:1}),l(n,{label:"\u5546\u94FA\u7B80\u4ECB"},{default:o(()=>[l(m,{value:e(a).description,"onUpdate:value":t[12]||(t[12]=u=>e(a).description=u)},null,8,["value"])]),_:1}),l(n,{label:"\u5546\u94FA\u5934\u50CF"},{default:o(()=>[l(N,{imageUrl:e(a).images,onOnSuccess:t[13]||(t[13]=u=>{e(a).images=u})},null,8,["imageUrl"])]),_:1}),l(n,{label:"\u5546\u94FA\u5730\u5740"},{default:o(()=>[l(m,{value:e(a).address,"onUpdate:value":t[14]||(t[14]=u=>e(a).address=u)},null,8,["value"])]),_:1}),l(n,{label:"\u5546\u94FA\u7535\u8BDD"},{default:o(()=>[l(m,{value:e(a).phone,"onUpdate:value":t[15]||(t[15]=u=>e(a).phone=u)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])])],64)}}});export{Ee as default};
